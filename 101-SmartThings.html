<!--
    Copyright 2020 Samsung Automation Studio Team

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<script type="text/x-red" data-template-name="device-profile">
    <div class="form-row">
        <label for="node-input-name">Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-capabilityId">Capability</label>
        <select type="text" id="node-input-capabilityId" style="width: 70%;"></select>
    </div>
</script>
<script type="text/x-red" data-help-name="device-profile">
    <p>This node represents an installed device. In this flow, You need to choose a device for automation.</p>
    <p>Event, Status and Command nodes need to know which devices will subscribe to the SmartThings Cloud or commands.</p>
    <p>This node has a capability that represents device feature. You can find more information about <a href="https://smartthings.developer.samsung.com/docs/api-ref/capabilities.html" target="_blank">the Capabilities of SmartThings</a>.</p>
    <h3>Properties</h3>
    <dl class="message-properties">
        <dt>Name<span class="property-type">required</span></dt>
        <dd>The label of the Name assigned by the user. It's unique name in flow.</dd>
        <dt>Capability<span class="property-type">required</span></dt>
        <dd>
            <ul>
                <li>The List of Capabilities provided by this Device.</li>
                <li>Determine if this Device supports the specified capability name.</li>
            </ul>
        </dd>
    </dl>
</script>
<script type="text/x-red" data-template-name="installed-device">
    <div class="form-tips" style="margin-bottom:10px;"><b>Note:</b> create token on the SmartThings <b><a href="https://account.smartthings.com/tokens" target="_blank">personal access token page</a></b></div>

    <div class="form-row">
        <label for="node-input-name">name</span></label>
        <input type="text" id="node-input-name" disabled>
    </div>
    <div class="form-row">
        <label for="node-input-name">label</label>
        <input type="text" id="node-input-label" disabled>
    </div>
    <div class="form-row">
        <label for="node-input-stAccessToken">Personal Access Token</label>
        <input type="text" id="node-input-stAccessToken">
    </div>
    <div id="my-device-list-div" class="form-row sensor-container-row">
        <ol id="my-device-list-container"></ol>
    </div>
</script>
<script type="text/x-red" data-help-name="installed-device">
    <p>This node represents an your SmartThings device. You can control your SmartThings devices directly without even registering the Automation.</p>
    <p>To do this, you should set your PAT on this node and select one on your device list. Then, you can get a condition or put a command to your installed devices by using 'Status', 'Command' nodes.</p>
    <p>After setting your PAT, get your device list and select device that you want to control.</p>
    <h3>Getting a SmartThings PAT</h3>
        <ul>
            <li>SmartThings Authentication : <a href="https://smartthings.developer.samsung.com/docs/api-ref/st-api.html#section/Authentication">API Reference, Authentication</a></li>
            <li>PATs can be created and managed on the <a href="https://account.smartthings.com/tokens">personal access token page</a>.</li>
        </ul>
    <h3>Properties</h3>
    <dl class="message-properties">
        <dt>Device Name<span class="property-type">read-only</span></dt>
        <dd>The label of the Name assigned by the user. It's unique name in flow.</dd>
        <dt>Device Label<span class="property-type">read-only</span></dt>
        <dd> </dd>
        <dt>Personal Access Token<span class="property-type">required</span></dt>
        <dd></dd>
        <dt>Device List</dt>
        <dd>
            <ul>
                <li>The List of your device that .</li>
                <li>Select device that you want to control, subscribe</li>
            </ul>
        </dd>
    </dl>
</script>
<script type="text/x-red" data-template-name="automation">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input id="node-input-name" type="text" placeholder="Name"/>
    </div>
    <div class="form-row">
        <label for="node-input-url"><i class="fa fa-cog"></i> Endpoint</label>
        <input id="node-input-url" type="text"  placeholder="/url"/>
    </div>
    <div class="form-row">
        <label for="node-input-copyurl"></label>
        <div style="display: inline-block; position: relative; width: 70%; height: 20.0114px;">
            <div style="position: absolute; left: 0px; right: 40px;">
                <input type="text" id="node-input-copyurl" readonly="true" style="width:100%"></input>
            </div>
            <a id="export-clipboard" class="editor-button" style="position: absolute; right: 0px; top: 0px;">
                <i class="fa fa-copy"></i>
            </a>
        </div>
    </div>
    <div class="form-row">
        <label for="node-input-publickey"><i class="fa fa-th"></i> Public Key</label>
        <textarea id="node-input-publickey" cols="60" rows="8"  style="margin: 0px; width: 354px; height: 174px;"></textarea>
    </div>
    <div class="form-tips"><b>Note:</b> How to get Public Key. See info box for details.</div>
</script>
<script type="text/x-red" data-help-name="automation">
    <p>This node represents the WebHook Endpoint of SmartApp. the Automation node handles lifecycle of SmartApp.</p>
    <p>A WebHook endpoint in this context is a web services application which can receive incoming HTTP POST requests.</p>
    <p></p>
    <p><a href="https://smartthings.developer.samsung.com/docs/guides/smartapps/webhook-apps.html" target="_blank">more...</a></p>
    <h3>Properties</h3>
    <dl class="message-properties">
        <dt>Name <span class="property-type">required</span></dt>
        <dd>A Name for the WebHook endpoint.</dd>
        <dt>Endpoint <span class="property-type">required</span></dt>
        <dd>A Endpoint that should be invoked during execution.</dd>
        <dt>Public Key <span class="property-type">required</span></dt>
        <dd>The public half of an RSA key pair. Useful for verifying a Webhook execution request signature to ensure it came from SmartThings.</dd>
    </dl>
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>[lifecyle] Event</dt>
        <dd>Next node is the Event node only.</dd>
    </dl>
    <h3>Detail</h3>
    <p><b>How to get the Public Key</b></p>
    <p>When you create SmartApp on the SmartThing Cloud, you can get the Public Key. You can regist Automation on the SmartThings Developer Workspace.</p>
    <p><a href="https://smartthings.developer.samsung.com/docs/workspace/tutorials/create-an-automation.html#Register-the-Automation" target="_blank">more...</a></p>
</script>

<script type="text/x-red" data-template-name="event-device">
    <div class="form-row" style="width:600px;">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name" style="width:50%">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-cog"></i> Device</label>
        <select type="text"  id="node-input-deviceNodeId" style="width:50%"></select>
    </div>
    <hr align="middle" />
    <div class="form-row">
        <label for="node-input-capabilityId"><i class="fa fa-asterisk"></i> Capability</label>
        <select id="node-input-capabilityId" style="width:50%;"></select>
    </div>
    <div class="form-row">
        <label for="node-input-attributeId"><i class="fa fa-sun-o"></i> Attribute</label>
        <select style="width:50%" id="node-input-attributeId"></select>
    </div>
    <div class="form-row sensor-container-row">
        <ol id="attr-list-container"></ol>
    </div>

</script>
<script type="text/x-red" data-help-name="event-device">
    <p>This node represents a change of device.</p>
    <p>When a user installs a SmartApp, they typically will select the devices to be used by the SmartApp.</p>
    <p>This event-device node interacts with installed SmartThings device. When the device changes and an event occurs, the event node can receive the event as a subscriber.</p>
    <h3>Properties</h3>
    <dl class="message-properties">
        <dt>Name <span class="property-type">required</span></dt>
        <dd>The label of the Device assigned by the user.</dd>
        <dt>Device </dt>
        <dd>The unique system identifier for this Device.</dd>
        <dt>Capability <span class="property-type">required</span></dt>
        <dd>
            <ul>
                <li>The List of Capabilities provided by this Device.</li>
                <li>Determine if this Device supports the specified capability name.</li>
            </ul>
        </dd>
        <dt>Attribute</dt>
        <dd>
            <ul>
                <li>The list of Attribute s for this Device.</li>
                <li>Determine if this Device has the specified attribute.</li>
            </ul>
        </dd>
     </dl>
</script>

<script type="text/x-red" data-template-name="status-device">
    <div class="form-row" style="width:600px;">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name" style="width:50%">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-cog"></i> Device</label>
        <select type="text"  id="node-input-deviceNodeId" style="width:50%"></select>
    </div>
    <hr align="middle" />
    <div class="form-row">
        <label for="node-input-capabilityId" style="font-weight:bold"> Filter</label>
    </div>
    <div class="form-row">
        <label for="node-input-capabilityId"><i class="fa fa-asterisk"></i> Capability</label>
        <select id="node-input-capabilityId" style="width:50%;"></select>
    </div>
    <div class="form-row">
        <label for="node-input-attributeId"> <i class="fa fa-sun-o"></i> Attribute</label>
        <select style="width:50%" id="node-input-attributeId"></select>
    </div>
    <div class="form-row sensor-container-row">
        <ol id="attr-list-container"></ol>
    </div>
</script>
<script type="text/x-red" data-help-name="status-device">
    <p>This node checks the state of the device.</p>
    <p>When a user installs a SmartApp, A user will select the devices to be used by the SmartApp.</p>
    <p>This status-device node interact with the installed SmartThings device. This node allows you to branch flows based on the state of the device.</p>
    <h3>Properties</h3>
    <dl class="message-properties">
        <dt>Name <span class="property-type">required</span></dt>
        <dd>The label of the Device assigned by the user.</dd>
        <dt>Device </dt>
        <dd>The unique system identifier for this Device.</dd>
        <dt>Capability <span class="property-type">required</span></dt>
        <dd>
            <ul>
                <li>The List of Capabilities provided by this Device.</li>
                <li>Determine if this Device supports the specified capability name.</li>
            </ul>
        </dd>
        <dt>Attribute</dt>
        <dd>
            <ul>
                <li>The list of Attribute s for this Device.</li>
                <li>Determine if this Device has the specified attribute.</li>
            </ul>
        </dd>
     </dl>
</script>

<script type="text/x-red" data-template-name="command-device">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name" style="width:50%">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-cog"></i> Device</label>
        <select type="text" id="node-input-deviceNodeId" style="width:50%"></select>
    </div>
    <hr align="middle" />
    <div class="form-row">
        <label for="node-input-capabilityId"><i class="fa fa-asterisk"></i> Capability</label>
        <select id="node-input-capabilityId" style="width:50%;"></select>
    </div>
    <div class="form-row">
        <label for="node-input-attributeId"> <i class="fa fa-sun-o"></i> Command</label>
        <select style="width:50%" id="node-input-attributeId"></select>
    </div>
    <div class="form-row actuator-container-row">
        <ol id="cmd-list-container"></ol>
    </div>

</script>
<script type="text/x-red" data-help-name="command-device">
    <p>This node can command to the device.</p>
    <p>When a user installs a SmartApp, A user will select the devices to be used by the SmartApp.</p>
    <p>This command-device node interact with the installed SmartThings device. As commands you set, this node changes the state of the device.</p>
    <h3>Properties</h3>
    <dl class="message-properties">
        <dt>Name <span class="property-type">required</span></dt>
        <dd>The label of the Device assigned by the user.</dd>
        <dt>Device </dt>
        <dd>The unique system identifier for this Device.</dd>
        <dt>Capability <span class="property-type">required</span></dt>
        <dd>
            <ul>
                <li>The List of Capabilities provided by this Device.</li>
                <li>Determine if this Device supports the specified capability name.</li>
            </ul>
        </dd>
        <dt>Command</dt>
        <dd>
            <ul>
                <li>The list of Commands for this Device.</li>
                <li>Determine if this Device has the specified command name.</li>
            </ul>
        </dd>
     </dl>
</script>
<!-- Node Html End-->

<script type="text/javascript">
    // https://api.smartthings.com/v1/devices
    SmartThingsApi = {
        getDeviceList: function (token, done, fail) {
            return $.ajax({
                url: "https://api.smartthings.com/v1/devices",
                headers: {
                    Authorization: 'Bearer ' + token
                }
            }).done(function (result, textStatus, xhr) {
                // var prs = []

                if(result.hasOwnProperty('items') && Array.isArray(result.items)){
                    result.items.forEach(device=>{
                        device.capabilities = []
                        device.components.forEach(function (component) {
                            component.capabilities.forEach(function (cp) {
                                cp['vid'] = cp.id+'_v'+cp.version;
                                cp['vname']=cp.version===1?cp.name:cp.name+' v'+cp.version;
                                device.capabilities.push(cp)

                                if(profiles.hasCapability(cp.vid)===false){
                                    var pr = SmartThingsApi.getCapability(token,cp.id,cp.version)
                                        .then(spec=>{
                                            // cp['spec']=true
                                            Object.assign(cp,spec)
                                            $('#my-device-list-container span.device-item-capability').attr('spec','true')
                                        }).fail(err=>{
                                            console.error(err)
                                            $('#my-device-list-container span.device-item-capability').attr('spec','false')
                                        })
                                        // .promise()
                                    // prs.push(pr)
                                }
                            })
                        })

                        delete device['components']
                        delete device['dth']
                        delete device['deviceNetworkType']
                        delete device['locationsId']
                    })
                }
                // Promise.allSettled(prs).then(()=>{
                done(result.items);
                // })
            }).fail(function (e) {
                fail(e);
            });
        },
        getCapability: function(token,capabilityId,capabilityVersion, done, fail){
            return $.ajax({
                // url: "https://api.smartthings.com/v1/devices",
                url: 'https://api.smartthings.com/v1/capabilities/'+capabilityId+'/'+capabilityVersion,
                headers: {
                        Authorization: 'Bearer '+token
                    }
            }).then((cp)=>{
                cp['vid']=cp.id+'_v'+cp.version //vid : id + version
                cp['vname']=(cp.version===1?cp.name:cp.name+' v'+cp.version)// vname : name + version
                cp['_spec']=true
                profiles.addCapability(cp)
                return cp;
            })
        }
    };
</script>
<style>
    .device-item-capability{
        color:#000;
    }
    .device-item-capability[spec='false']{
        color:#999;
    }

</style>
<!-- Node Common Script-->
<script type="text/javascript">

    function Profiles() {
        /*
        * capability ver.2020.03.30
        * https://smartthings.developer.samsung.com/docs/api-ref/capabilities.html
        */
        var _raw_capabilities = [{"id":"tvChannel","version":1,"status":"proposed","name":"Tv Channel","attributes":{"tvChannel":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"setter":"setTvChannel","enumCommands":[]},"tvChannelName":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"setter":"setTvChannelName","enumCommands":[]}},"commands":{"setTvChannel":{"arguments":[{"name":"tvChannel","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]},"channelUp":{"arguments":[]},"channelDown":{"arguments":[]},"setTvChannelName":{"arguments":[{"name":"tvChannelName","optional":true,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"statelessRobotCleanerToggleButton","version":1,"status":"proposed","name":"Stateless Robot Cleaner Toggle Button","attributes":{"availableRobotCleanerToggleButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["actionToggle"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["actionToggle"]}}]}}},{"id":"mediaPlaybackShuffle","version":1,"status":"proposed","name":"Media Playback Shuffle","attributes":{"playbackShuffle":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["disabled","enabled"]}},"additionalProperties":false,"required":["value"]},"setter":"setPlaybackShuffle","enumCommands":[]}},"commands":{"setPlaybackShuffle":{"arguments":[{"name":"shuffle","optional":false,"schema":{"type":"string","enum":["disabled","enabled"]}}]}}},{"id":"robotCleanerTurboMode","version":1,"status":"proposed","name":"Robot Cleaner Turbo Mode","attributes":{"robotCleanerTurboMode":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["on","off","silence"]}},"additionalProperties":false,"required":["value"]},"setter":"setRobotCleanerTurboMode","enumCommands":[]}},"commands":{"setRobotCleanerTurboMode":{"arguments":[{"name":"mode","optional":false,"schema":{"type":"string","enum":["on","off","silence"]}}]}}},{"id":"bodyWeightMeasurement","version":1,"status":"proposed","name":"Body Weight Measurement","attributes":{"bodyWeightMeasurement":{"schema":{"type":"object","properties":{"value":{"type":"number"},"unit":{"type":"string","enum":["kg","lbs","斤"],"default":"kg"}},"additionalProperties":false,"required":["value","unit"]},"enumCommands":[]}},"commands":{}},{"id":"battery","version":1,"status":"live","name":"Battery","attributes":{"battery":{"schema":{"title":"IntegerPercent","type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"speechSynthesis","version":1,"status":"proposed","name":"Speech Synthesis","attributes":{},"commands":{"speak":{"arguments":[{"name":"phrase","optional":false,"schema":{"type":"string","maxLength":1000}}]}}},{"id":"colorControl","version":1,"status":"live","name":"Color Control","attributes":{"color":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"setter":"setColor","enumCommands":[]},"hue":{"schema":{"type":"object","properties":{"value":{"title":"PositiveNumber","type":"number","minimum":0}},"additionalProperties":false,"required":[]},"setter":"setHue","enumCommands":[]},"saturation":{"schema":{"type":"object","properties":{"value":{"title":"PositiveNumber","type":"number","minimum":0}},"additionalProperties":false,"required":[]},"setter":"setSaturation","enumCommands":[]}},"commands":{"setColor":{"arguments":[{"name":"color","optional":false,"schema":{"title":"COLOR_MAP","type":"object","additionalProperties":false,"properties":{"hue":{"type":"number"},"saturation":{"type":"number"},"hex":{"type":"string","maxLength":7},"level":{"type":"integer"},"switch":{"type":"string","maxLength":3}}}}]},"setHue":{"arguments":[{"name":"hue","optional":false,"schema":{"title":"PositiveNumber","type":"number","minimum":0}}]},"setSaturation":{"arguments":[{"name":"saturation","optional":false,"schema":{"title":"PositiveNumber","type":"number","minimum":0}}]}}},{"id":"remoteControlStatus","version":1,"status":"live","name":"Remote Control Status","attributes":{"remoteControlEnabled":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["false","true"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"color","version":1,"status":"proposed","name":"Color","attributes":{"colorValue":{"schema":{"type":"object","properties":{"value":{"type":"object","additionalProperties":false,"properties":{"hue":{"type":"number","minimum":0,"maximum":360},"saturation":{"type":"number","minimum":0,"maximum":100}}}},"additionalProperties":false,"required":["value"]},"setter":"setColorValue","enumCommands":[]}},"commands":{"setColorValue":{"arguments":[{"name":"colorValue","optional":false,"schema":{"type":"object","additionalProperties":false,"properties":{"hue":{"type":"number","minimum":0,"maximum":360},"saturation":{"type":"number","minimum":0,"maximum":100}},"required":["hue","saturation"]}},{"name":"switchLevel","optional":true,"schema":{"type":"integer","minimum":0,"maximum":100}}]}}},{"id":"accelerationSensor","version":1,"status":"live","name":"Acceleration Sensor","attributes":{"acceleration":{"schema":{"type":"object","properties":{"value":{"title":"ActivityState","type":"string","enum":["active","inactive"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"switch","version":1,"status":"live","name":"Switch","attributes":{"switch":{"schema":{"type":"object","properties":{"value":{"title":"SwitchState","type":"string","enum":["on","off"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"on","value":"on"},{"command":"off","value":"off"}]}},"commands":{"off":{"arguments":[]},"on":{"arguments":[]}}},{"id":"dishwasherMode","version":1,"status":"proposed","name":"Dishwasher Mode","attributes":{"dishwasherMode":{"schema":{"type":"object","properties":{"value":{"title":"DishwasherMode","type":"string","enum":["auto","quick","rinse","dry"]}},"additionalProperties":false,"required":["value"]},"setter":"setDishwasherMode","enumCommands":[]}},"commands":{"setDishwasherMode":{"arguments":[{"name":"mode","optional":false,"schema":{"title":"DishwasherMode","type":"string","enum":["auto","quick","rinse","dry"]}}]}}},{"id":"audioTrackAddressing","version":1,"status":"proposed","name":"Audio Track Addressing","attributes":{},"commands":{"setAudioTrack":{"arguments":[{"name":"trackToSet","optional":false,"schema":{"title":"AudioTrackAddress","type":"object"}}]}}},{"id":"statelessSetChannelButton","version":1,"status":"proposed","name":"Stateless Set Channel Button","attributes":{},"commands":{"setChannel":{"arguments":[{"name":"channel","optional":false,"schema":{"type":"string"}}]}}},{"id":"thermostat","version":1,"status":"deprecated","name":"Thermostat","attributes":{"coolingSetpoint":{"schema":{"title":"Temperature","type":"object","properties":{"value":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},"unit":{"type":"string","enum":["F","C"]}},"additionalProperties":false,"required":["value","unit"]},"setter":"setCoolingSetpoint","enumCommands":[]},"coolingSetpointRange":{"schema":{"type":"object","properties":{"value":{"type":"array","items":[{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000}],"minItems":2,"maxItems":2}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"heatingSetpoint":{"schema":{"title":"Temperature","type":"object","properties":{"value":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},"unit":{"type":"string","enum":["F","C"]}},"additionalProperties":false,"required":["value","unit"]},"setter":"setHeatingSetpoint","enumCommands":[]},"heatingSetpointRange":{"schema":{"type":"object","properties":{"value":{"type":"array","items":[{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000}],"minItems":2,"maxItems":2}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"schedule":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"setter":"setSchedule","enumCommands":[]},"temperature":{"schema":{"title":"Temperature","type":"object","properties":{"value":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},"unit":{"type":"string","enum":["F","C"]}},"additionalProperties":false,"required":["value","unit"]},"enumCommands":[]},"thermostatFanMode":{"schema":{"type":"object","properties":{"value":{"title":"ThermostatFanMode","type":"string","enum":["auto","circulate","followschedule","on"]},"data":{"type":"object","additionalProperties":false,"required":[],"properties":{"supportedThermostatFanModes":{"type":"array","items":{"title":"ThermostatFanMode","type":"string","enum":["auto","circulate","followschedule","on"]}}}}},"additionalProperties":false,"required":["value"]},"setter":"setThermostatFanMode","enumCommands":[{"command":"fanAuto","value":"auto"},{"command":"fanCirculate","value":"circulate"},{"command":"fanOn","value":"on"}]},"supportedThermostatFanModes":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"ThermostatFanMode","type":"string","enum":["auto","circulate","followschedule","on"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]},"thermostatMode":{"schema":{"type":"object","properties":{"value":{"title":"ThermostatMode","type":"string","enum":["asleep","auto","autowitheco","autowithreset","autochangeover","autochangeoveractive","autocool","autoheat","auxheatonly","auxiliaryemergencyheat","away","cool","custom","dayoff","dryair","eco","emergency heat","emergencyheat","emergencyheatactive","energysavecool","energysaveheat","fanonly","frostguard","furnace","heat","heatingoff","home","in","manual","moistair","off","out","resume","rush hour","rushhour","schedule","southernaway"]},"data":{"type":"object","additionalProperties":false,"required":[],"properties":{"supportedThermostatModes":{"type":"array","items":{"title":"ThermostatMode","type":"string","enum":["asleep","auto","autowitheco","autowithreset","autochangeover","autochangeoveractive","autocool","autoheat","auxheatonly","auxiliaryemergencyheat","away","cool","custom","dayoff","dryair","eco","emergency heat","emergencyheat","emergencyheatactive","energysavecool","energysaveheat","fanonly","frostguard","furnace","heat","heatingoff","home","in","manual","moistair","off","out","resume","rush hour","rushhour","schedule","southernaway"]}}}}},"additionalProperties":false,"required":["value"]},"setter":"setThermostatMode","enumCommands":[{"command":"auto","value":"auto"},{"command":"cool","value":"cool"},{"command":"emergencyHeat","value":"emergency heat"},{"command":"heat","value":"heat"},{"command":"off","value":"off"}]},"supportedThermostatModes":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"ThermostatMode","type":"string","enum":["asleep","auto","autowitheco","autowithreset","autochangeover","autochangeoveractive","autocool","autoheat","auxheatonly","auxiliaryemergencyheat","away","cool","custom","dayoff","dryair","eco","emergency heat","emergencyheat","emergencyheatactive","energysavecool","energysaveheat","fanonly","frostguard","furnace","heat","heatingoff","home","in","manual","moistair","off","out","resume","rush hour","rushhour","schedule","southernaway"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]},"thermostatOperatingState":{"schema":{"type":"object","properties":{"value":{"title":"ThermostatOperatingState","type":"string","enum":["cooling","fan only","heating","idle","pending cool","pending heat","vent economizer"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"thermostatSetpoint":{"schema":{"title":"Temperature","type":"object","properties":{"value":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},"unit":{"type":"string","enum":["F","C"]}},"additionalProperties":false,"required":["value","unit"]},"enumCommands":[]},"thermostatSetpointRange":{"schema":{"type":"object","properties":{"value":{"type":"array","items":[{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000}],"minItems":2,"maxItems":2}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"auto":{"arguments":[]},"cool":{"arguments":[]},"emergencyHeat":{"arguments":[]},"fanAuto":{"arguments":[]},"fanCirculate":{"arguments":[]},"fanOn":{"arguments":[]},"heat":{"arguments":[]},"off":{"arguments":[]},"setCoolingSetpoint":{"arguments":[{"name":"setpoint","optional":false,"schema":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000}}]},"setHeatingSetpoint":{"arguments":[{"name":"setpoint","optional":false,"schema":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000}}]},"setSchedule":{"arguments":[{"name":"schedule","optional":false,"schema":{"title":"JsonObject","type":"object"}}]},"setThermostatFanMode":{"arguments":[{"name":"fanmode","optional":false,"schema":{"title":"ThermostatFanMode","type":"string","enum":["auto","circulate","followschedule","on"]}}]},"setThermostatMode":{"arguments":[{"name":"mode","optional":false,"schema":{"title":"ThermostatMode","type":"string","enum":["asleep","auto","autowitheco","autowithreset","autochangeover","autochangeoveractive","autocool","autoheat","auxheatonly","auxiliaryemergencyheat","away","cool","custom","dayoff","dryair","eco","emergency heat","emergencyheat","emergencyheatactive","energysavecool","energysaveheat","fanonly","frostguard","furnace","heat","heatingoff","home","in","manual","moistair","off","out","resume","rush hour","rushhour","schedule","southernaway"]}}]}}},{"id":"estimatedTimeOfArrival","version":1,"status":"proposed","name":"Estimated Time Of Arrival","attributes":{"eta":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"statelessAudioVolumeButton","version":1,"status":"live","name":"Stateless Audio Volume Button","attributes":{"availableAudioVolumeButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["volumeUp","volumeDown"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["volumeUp","volumeDown"]}}]}}},{"id":"airFlowDirection","version":1,"status":"dead","name":"Air Flow Direction","attributes":{"airFlowDirection":{"schema":{"type":"object","properties":{"value":{"title":"AirFlowDirection","type":"string","enum":["fixed","vertical","horizontal","all"]}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setAirFlowDirection":{"arguments":[{"name":"airFlowDirection","optional":false,"schema":{"title":"AirFlowDirection","type":"string","enum":["fixed","vertical","horizontal","all"]}}]}}},{"id":"atmosphericPressureMeasurement","version":1,"status":"proposed","name":"Atmospheric Pressure Measurement","attributes":{"atmosphericPressure":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":110},"unit":{"type":"string","enum":["kPa"],"default":"kPa"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"consumable","version":1,"status":"proposed","name":"Consumable","attributes":{"consumableStatus":{"schema":{"type":"object","properties":{"value":{"title":"ConsumableState","type":"string","enum":["good","maintenance_required","missing","order","replace"]}},"additionalProperties":false,"required":["value"]},"setter":"setConsumableStatus","enumCommands":[]}},"commands":{"setConsumableStatus":{"arguments":[{"name":"status","optional":false,"schema":{"title":"ConsumableState","type":"string","enum":["good","maintenance_required","missing","order","replace"]}}]}}},{"id":"dishwasherOperatingState","version":1,"status":"proposed","name":"Dishwasher Operating State","attributes":{"machineState":{"schema":{"type":"object","properties":{"value":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}},"additionalProperties":false,"required":["value"]},"setter":"setMachineState","enumCommands":[]},"supportedMachineStates":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"dishwasherJobState":{"schema":{"type":"object","properties":{"value":{"title":"DishwasherJobState","type":"string","enum":["airwash","cooling","drying","finish","preDrain","prewash","rinse","spin","unknown","wash","wrinklePrevent"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"completionTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"setMachineState":{"arguments":[{"name":"state","optional":false,"schema":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}}]}}},{"id":"signalStrength","version":1,"status":"live","name":"Signal Strength","attributes":{"lqi":{"schema":{"type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"rssi":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":-200,"maximum":0},"unit":{"type":"string","enum":["dBm"],"default":"dBm"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"radonMeasurement","version":1,"status":"proposed","name":"Radon Measurement","attributes":{"radonLevel":{"schema":{"type":"object","properties":{"value":{"type":"number"},"unit":{"type":"string","enum":["pCi/L"],"default":"pCi/L"}},"additionalProperties":false,"required":["value","unit"]},"enumCommands":[]}},"commands":{}},{"id":"elevatorCall","version":1,"status":"proposed","name":"Elevator Call","attributes":{"callStatus":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["called","standby","unknown"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"call":{"arguments":[]}}},{"id":"webrtc","version":1,"status":"proposed","name":"webrtc","attributes":{"supportedFeatures":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string"}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"audioOnly":{"schema":{"type":"object","properties":{"value":{"type":"boolean"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"sdpAnswer":{"schema":{"type":"object","properties":{"value":{"type":"object","additionalProperties":false,"properties":{"id":{"type":"string"},"sdp":{"type":"string"},"turn_url":{"type":"string"},"turn_user":{"type":"string"},"turn_pwd":{"type":"string"}},"required":["id","sdp"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"talkback":{"schema":{"type":"object","properties":{"value":{"type":"boolean"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"stunUrl":{"schema":{"type":"object","properties":{"value":{"title":"URL","type":"string","pattern":"^(https?):\\/\\/((?:[a-zA-Z0-9.-]|%[0-9A-F]{2}){3,})(?::(\\d+))?((?:\\/(?:[a-z0-9-._~!$&'()*+,;=:@]|%[0-9A-F]{2})*)*)(?:\\?((?:[a-zA-Z0-9-._~!$&'()*+,;=:\\/?@]|%[0-9A-F]{2})*))?(?:#((?:[a-zA-Z0-9-._~!$&'()*+,;=:\\/?@]|%[0-9A-F]{2})*))?$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"sdpOffer":{"arguments":[{"name":"id","optional":false,"schema":{"type":"string"}},{"name":"sdp","optional":false,"schema":{"type":"string"}}]},"end":{"arguments":[{"name":"id","optional":false,"schema":{"type":"string"}}]}}},{"id":"videoStream","version":1,"status":"live","name":"Video Stream","attributes":{"stream":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"startStream":{"arguments":[]},"stopStream":{"arguments":[]}}},{"id":"mediaTrackControl","version":1,"status":"proposed","name":"Media Track Control","attributes":{"supportedTrackControlCommands":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"MediaTrackCommands","type":"string","enum":["previousTrack","nextTrack"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"nextTrack":{"arguments":[]},"previousTrack":{"arguments":[]}}},{"id":"locationMode","version":1,"status":"live","name":"Location Mode","attributes":{"mode":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"setter":"setMode","enumCommands":[]}},"commands":{"setMode":{"arguments":[{"name":"mode","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"statelessPowerToggleButton","version":1,"status":"live","name":"Stateless Power Toggle Button","attributes":{"availablePowerToggleButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["powerToggle"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["powerToggle"]}}]}}},{"id":"carbonMonoxideMeasurement","version":1,"status":"proposed","name":"Carbon Monoxide Measurement","attributes":{"carbonMonoxideLevel":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":1000000},"unit":{"type":"string","enum":["ppm"],"default":"ppm"}},"additionalProperties":false,"required":["value","unit"]},"enumCommands":[]}},"commands":{}},{"id":"activityLightingMode","version":1,"status":"proposed","name":"Activity Lighting Mode","attributes":{"lightingMode":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["reading","writing","computer","night","sleepPreparation","day","cozy","soft"]}},"additionalProperties":false,"required":["value"]},"setter":"setLightingMode","enumCommands":[]}},"commands":{"setLightingMode":{"arguments":[{"name":"lightingMode","optional":false,"schema":{"type":"string","enum":["reading","writing","computer","night","sleepPreparation","day","cozy","soft"]}}]}}},{"id":"panicAlarm","version":1,"status":"live","name":"Panic Alarm","attributes":{"panicAlarm":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["panic","clear"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"ovenSetpoint","version":1,"status":"proposed","name":"Oven Setpoint","attributes":{"ovenSetpoint":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"setter":"setOvenSetpoint","enumCommands":[]}},"commands":{"setOvenSetpoint":{"arguments":[{"name":"setpoint","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]}}},{"id":"tvocMeasurement","version":1,"status":"live","name":"Tvoc Measurement","attributes":{"tvocLevel":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":1000000},"unit":{"type":"string","enum":["ppm"],"default":"ppm"}},"additionalProperties":false,"required":["value","unit"]},"enumCommands":[]}},"commands":{}},{"id":"timedSession","version":1,"status":"proposed","name":"Timed Session","attributes":{"sessionStatus":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["canceled","paused","running","stopped"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"cancel","value":"canceled"},{"command":"pause","value":"paused"},{"command":"start","value":"running"},{"command":"stop","value":"stopped"}]},"completionTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"setter":"setCompletionTime","enumCommands":[]}},"commands":{"cancel":{"arguments":[]},"pause":{"arguments":[]},"setCompletionTime":{"arguments":[{"name":"completionTime","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}}]},"start":{"arguments":[]},"stop":{"arguments":[]}}},{"id":"outlet","version":1,"status":"deprecated","name":"Outlet","attributes":{"switch":{"schema":{"type":"object","properties":{"value":{"title":"SwitchState","type":"string","enum":["on","off"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"on","value":"on"},{"command":"off","value":"off"}]}},"commands":{"off":{"arguments":[]},"on":{"arguments":[]}}},{"id":"lockCodes","version":1,"status":"proposed","name":"Lock Codes","attributes":{"codeChanged":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"codeReport":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"lockCodes":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"scanCodes":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"codeLength":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"setter":"setCodeLength","enumCommands":[]},"maxCodes":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]},"maxCodeLength":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]},"minCodeLength":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]},"lock":{"schema":{"type":"object","properties":{"value":{"title":"LockState","type":"string","enum":["locked","unknown","unlocked","unlocked with timeout"]}},"additionalProperties":false,"required":[]},"enumCommands":[{"command":"lock","value":"locked"},{"command":"unlock","value":"unlocked"},{"command":"unlockWithTimeout","value":"unlocked with timeout"}]}},"commands":{"updateCodes":{"arguments":[{"name":"codes","optional":false,"schema":{"title":"JsonObject","type":"object"}}]},"deleteCode":{"arguments":[{"name":"codeSlot","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]},"lock":{"arguments":[]},"reloadAllCodes":{"arguments":[]},"requestCode":{"arguments":[{"name":"codeSlot","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]},"setCode":{"arguments":[{"name":"codeSlot","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}},{"name":"codePIN","optional":false,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"codeName","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]},"unlock":{"arguments":[]},"unlockWithTimeout":{"arguments":[]},"setCodeLength":{"arguments":[{"name":"length","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]},"nameSlot":{"arguments":[{"name":"codeSlot","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}},{"name":"codeName","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"holdableButton","version":1,"status":"deprecated","name":"Holdable Button","attributes":{"button":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["held","pushed"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"numberOfButtons":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"polling","version":1,"status":"deprecated","name":"Polling","attributes":{},"commands":{"poll":{"arguments":[]}}},{"id":"presenceSensor","version":1,"status":"live","name":"Presence Sensor","attributes":{"presence":{"schema":{"type":"object","properties":{"value":{"title":"PresenceState","type":"string","enum":["present","not present"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"doorControl","version":1,"status":"live","name":"Door Control","attributes":{"door":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["closed","closing","open","opening","unknown"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"close","value":"closed"},{"command":"open","value":"open"}]}},"commands":{"close":{"arguments":[]},"open":{"arguments":[]}}},{"id":"statelessSetChannelByContentButton","version":1,"status":"proposed","name":"Stateless Set Channel By Content Button","attributes":{},"commands":{"setChannelByContent":{"arguments":[{"name":"contentName","optional":false,"schema":{"type":"string"}}]}}},{"id":"bridge","version":1,"status":"deprecated","name":"Bridge","attributes":{},"commands":{}},{"id":"geofence","version":1,"status":"proposed","name":"Geofence","attributes":{"name":{"schema":{"type":"object","properties":{"value":{"type":"string"}},"additionalProperties":false,"required":["value"]},"setter":"setName","enumCommands":[]},"geofence":{"schema":{"type":"object","properties":{"value":{"title":"GeofenceRadiusData","type":"object","additionalProperties":false,"properties":{"longitude":{"type":"number"},"latitude":{"type":"number"},"radius":{"type":"number"}}}},"additionalProperties":false,"required":["value"]},"setter":"setGeofence","enumCommands":[]},"enableState":{"schema":{"type":"object","properties":{"value":{"title":"EnableState","type":"string","enum":["enabled","disabled"]}},"additionalProperties":false,"required":["value"]},"setter":"setEnableState","enumCommands":[]}},"commands":{"setName":{"arguments":[{"name":"name","optional":false,"schema":{"type":"string"}}]},"setGeofence":{"arguments":[{"name":"geofence","optional":false,"schema":{"title":"GeofenceRadiusData","type":"object","additionalProperties":false,"properties":{"longitude":{"type":"number"},"latitude":{"type":"number"},"radius":{"type":"number"}}}}]},"setEnableState":{"arguments":[{"name":"enableState","optional":false,"schema":{"title":"EnableState","type":"string","enum":["enabled","disabled"]}}]}}},{"id":"equivalentCarbonDioxideMeasurement","version":1,"status":"live","name":"Equivalent Carbon Dioxide Measurement","attributes":{"equivalentCarbonDioxideMeasurement":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":1000000},"unit":{"type":"string","enum":["ppm"],"default":"ppm"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"dryerOperatingState","version":1,"status":"proposed","name":"Dryer Operating State","attributes":{"machineState":{"schema":{"type":"object","properties":{"value":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}},"additionalProperties":false,"required":["value"]},"setter":"setMachineState","enumCommands":[]},"supportedMachineStates":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"dryerJobState":{"schema":{"type":"object","properties":{"value":{"title":"DryerJobState","type":"string","enum":["cooling","delayWash","drying","finished","none","weightSensing","wrinklePrevent"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"completionTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"setMachineState":{"arguments":[{"name":"state","optional":false,"schema":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}}]}}},{"id":"voltageMeasurement","version":1,"status":"live","name":"Voltage Measurement","attributes":{"voltage":{"schema":{"type":"object","properties":{"value":{"title":"Number","type":"number"},"unit":{"type":"string","enum":["V"],"default":"V"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"robotCleanerState","version":1,"status":"deprecated","name":"Robot Cleaner State","attributes":{"robotCleanerCleaningState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["cleaningAuto","cleaningManual","cleaningPart","cleaningRepeat","cleaningStop"]}},"additionalProperties":false,"required":[]},"setter":"setRobotCleanerCleaningState","enumCommands":[]},"robotCleanerControlState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["controlAfter","controlAlarm","controlCharging","controlCleaning","controlHoming","controlIdle","controlPause","controlPoint","controlPowerOff","controlReserve"]}},"additionalProperties":false,"required":[]},"setter":"setRobotCleanerControlState","enumCommands":[]},"robotCleanerTurboState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["turboOff","turboOn","turboSilence"]}},"additionalProperties":false,"required":[]},"setter":"setRobotCleanerTurboState","enumCommands":[]},"supportedRobotCleanerStates":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["cleaningAuto","cleaningManual","cleaningPart","cleaningRepeat","cleaningStop"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setRobotCleanerCleaningState":{"arguments":[{"name":"state","optional":false,"schema":{"type":"string","enum":["cleaningAuto","cleaningStop"]}}]},"setRobotCleanerControlState":{"arguments":[{"name":"state","optional":false,"schema":{"type":"string","enum":["controlHoming"]}}]},"setRobotCleanerTurboState":{"arguments":[{"name":"state","optional":false,"schema":{"type":"string","enum":["turboOff","turboOn","turboSilence"]}}]},"stop":{"arguments":[]}}},{"id":"statelessFanspeedModeButton","version":1,"status":"proposed","name":"Stateless Fanspeed Mode Button","attributes":{"availableFanspeedModeButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["changeMode"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["changeMode"]}}]}}},{"id":"soundDetection","version":1,"status":"proposed","name":"Sound Detection","attributes":{"soundDetectionState":{"schema":{"type":"object","properties":{"value":{"title":"EnableState","type":"string","enum":["enabled","disabled"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"enableSoundDetection","value":"enabled"},{"command":"disableSoundDetection","value":"disabled"}]},"soundDetected":{"schema":{"type":"object","properties":{"value":{"title":"DetectedSoundType","type":"string","enum":["noSound","babyCrying","glassBreaking","fireAlarm","dogBarking","catMeowing"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"supportedSoundTypes":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"DetectedSoundType","type":"string","enum":["noSound","babyCrying","glassBreaking","fireAlarm","dogBarking","catMeowing"]}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"enableSoundDetection":{"arguments":[]},"disableSoundDetection":{"arguments":[]}}},{"id":"statelessSetChannelByNameButton","version":1,"status":"proposed","name":"Stateless Set Channel By Name Button","attributes":{},"commands":{"setChannelByName":{"arguments":[{"name":"channel","optional":false,"schema":{"type":"string"}}]}}},{"id":"statelessCurtainPowerButton","version":1,"status":"proposed","name":"Stateless Curtain Power Button","attributes":{"availableCurtainPowerButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["open","close","pause"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["open","close","pause"]}}]}}},{"id":"mediaController","version":1,"status":"proposed","name":"Media Controller","attributes":{"activities":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"currentActivity":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"startActivity":{"arguments":[{"name":"activityId","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"securitySystem","version":1,"status":"live","name":"Security System","attributes":{"securitySystemStatus":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["armedAway","armedStay","disarmed"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"armStay","value":"armedStay"},{"command":"armAway","value":"armedAway"},{"command":"disarm","value":"disarmed"}]},"alarm":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"armStay":{"arguments":[{"name":"bypassAll","optional":false,"schema":{"type":"boolean"}}]},"armAway":{"arguments":[{"name":"bypassAll","optional":false,"schema":{"type":"boolean"}}]},"disarm":{"arguments":[]}}},{"id":"wirelessOperatingMode","version":1,"status":"proposed","name":"Wireless Operating Mode","attributes":{"wirelessOperatingMode":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["whenNeeded","alwaysOn"]}},"additionalProperties":false,"required":["value"]},"setter":"setWirelessOperatingMode","enumCommands":[]}},"commands":{"setWirelessOperatingMode":{"arguments":[{"name":"wirelessOperatingMode","optional":false,"schema":{"type":"string","enum":["whenNeeded","alwaysOn"]}}]}}},{"id":"light","version":1,"status":"deprecated","name":"Light","attributes":{"switch":{"schema":{"type":"object","properties":{"value":{"title":"SwitchState","type":"string","enum":["on","off"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"on","value":"on"},{"command":"off","value":"off"}]}},"commands":{"off":{"arguments":[]},"on":{"arguments":[]}}},{"id":"videoCapture","version":1,"status":"live","name":"Video Capture","attributes":{"clip":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"stream":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"capture":{"arguments":[{"name":"startTime","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},{"name":"captureTime","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},{"name":"endTime","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},{"name":"correlationId","optional":true,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"reason","optional":true,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"washerOperatingState","version":1,"status":"proposed","name":"Washer Operating State","attributes":{"machineState":{"schema":{"type":"object","properties":{"value":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}},"additionalProperties":false,"required":["value"]},"setter":"setMachineState","enumCommands":[]},"supportedMachineStates":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]},"washerJobState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["airWash","cooling","delayWash","drying","finish","none","preWash","rinse","spin","wash","weightSensing","wrinklePrevent"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"completionTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"setMachineState":{"arguments":[{"name":"state","optional":false,"schema":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}}]}}},{"id":"audioTrackData","version":1,"status":"proposed","name":"Audio Track Data","attributes":{"audioTrackData":{"schema":{"type":"object","properties":{"value":{"title":"AudioTrackData","type":"object","additionalProperties":false,"properties":{"title":{"title":"String","type":"string","maxLength":255},"artist":{"title":"String","type":"string","maxLength":255},"album":{"title":"String","type":"string","maxLength":255},"albumArtUrl":{"title":"String","type":"string","maxLength":255},"mediaSource":{"title":"String","type":"string","maxLength":255}},"required":["title"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"totalTime":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]},"elapsedTime":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{}},{"id":"mediaInputSource","version":1,"status":"proposed","name":"Media Input Source","attributes":{"inputSource":{"schema":{"type":"object","properties":{"value":{"title":"MediaSource","type":"string","enum":["AM","CD","FM","HDMI","HDMI1","HDMI2","HDMI3","HDMI4","HDMI5","HDMI6","digitalTv","USB","YouTube","aux","bluetooth","digital","melon","wifi"]}},"additionalProperties":false,"required":["value"]},"setter":"setInputSource","enumCommands":[]},"supportedInputSources":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"MediaSource","type":"string","enum":["AM","CD","FM","HDMI","HDMI1","HDMI2","HDMI3","HDMI4","HDMI5","HDMI6","digitalTv","USB","YouTube","aux","bluetooth","digital","melon","wifi"]}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"setInputSource":{"arguments":[{"name":"mode","optional":false,"schema":{"title":"MediaSource","type":"string","enum":["AM","CD","FM","HDMI","HDMI1","HDMI2","HDMI3","HDMI4","HDMI5","HDMI6","digitalTv","USB","YouTube","aux","bluetooth","digital","melon","wifi"]}}]}}},{"id":"smokeDetector","version":1,"status":"live","name":"Smoke Detector","attributes":{"smoke":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["clear","detected","tested"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"thermostatOperatingState","version":1,"status":"live","name":"Thermostat Operating State","attributes":{"thermostatOperatingState":{"schema":{"type":"object","properties":{"value":{"title":"ThermostatOperatingState","type":"string","enum":["cooling","fan only","heating","idle","pending cool","pending heat","vent economizer"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"infraredLevel","version":1,"status":"live","name":"Infrared Level","attributes":{"infraredLevel":{"schema":{"title":"Percent","type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"additionalProperties":false,"required":["value"]},"setter":"setInfraredLevel","enumCommands":[]}},"commands":{"setInfraredLevel":{"arguments":[{"name":"level","optional":false,"schema":{"type":"number","minimum":0,"maximum":100}}]}}},{"id":"beacon","version":1,"status":"deprecated","name":"Beacon","attributes":{"presence":{"schema":{"type":"object","properties":{"value":{"title":"PresenceState","type":"string","enum":["present","not present"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"refresh","version":1,"status":"live","name":"Refresh","attributes":{},"commands":{"refresh":{"arguments":[]}}},{"id":"statelessPowerButton","version":1,"status":"live","name":"Stateless Power Button","attributes":{"availablePowerButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["powerOn","powerOff"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["powerOn","powerOff"]}}]}}},{"id":"statelessVolumeButtonWithRepetition","version":1,"status":"proposed","name":"Stateless Volume Button With Repetition","attributes":{},"commands":{"volumeUp":{"arguments":[{"name":"repetition","optional":false,"schema":{"type":"integer","minimum":0,"maximum":10}}]},"volumeDown":{"arguments":[{"name":"repetition","optional":false,"schema":{"type":"integer","minimum":0,"maximum":10}}]}}},{"id":"audioCapture","version":1,"status":"proposed","name":"Audio Capture","attributes":{"clip":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"stream":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"capture":{"arguments":[{"name":"startTime","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},{"name":"captureTime","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},{"name":"endTime","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},{"name":"correlationId","optional":true,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"reason","optional":true,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"button","version":1,"status":"live","name":"Button","attributes":{"button":{"schema":{"type":"object","properties":{"value":{"title":"ButtonState","type":"string","enum":["pushed","held","double","pushed_2x","pushed_3x","pushed_4x","pushed_5x","pushed_6x","down","down_2x","down_3x","down_4x","down_5x","down_6x","down_hold","up","up_2x","up_3x","up_4x","up_5x","up_6x","up_hold"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"numberOfButtons":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"supportedButtonValues":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"ButtonState","type":"string","enum":["pushed","held","double","pushed_2x","pushed_3x","pushed_4x","pushed_5x","pushed_6x","down","down_2x","down_3x","down_4x","down_5x","down_6x","down_hold","up","up_2x","up_3x","up_4x","up_5x","up_6x","up_hold"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{}},{"id":"bodyMassIndexMeasurement","version":1,"status":"proposed","name":"Body Mass Index Measurement","attributes":{"bmiMeasurement":{"schema":{"type":"object","properties":{"value":{"type":"number"},"unit":{"type":"string","enum":["kg/m^2"],"default":"kg/m^2"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"tone","version":1,"status":"live","name":"Tone","attributes":{},"commands":{"beep":{"arguments":[]}}},{"id":"occupancySensor","version":1,"status":"proposed","name":"Occupancy Sensor","attributes":{"occupancy":{"schema":{"type":"object","properties":{"value":{"title":"OccupancyState","type":"string","enum":["occupied","unoccupied"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"firmwareUpdate","version":1,"status":"proposed","name":"Firmware Update","attributes":{"availableVersion":{"schema":{"type":"object","properties":{"value":{"type":"string"}},"additionalProperties":false,"required":[]},"enumCommands":[]},"currentVersion":{"schema":{"type":"object","properties":{"value":{"type":"string"}},"additionalProperties":false,"required":[]},"enumCommands":[]},"lastUpdateTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":[]},"enumCommands":[]},"lastUpdateStatus":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["updateSucceeded","updateFailed"]}},"additionalProperties":false,"required":[]},"enumCommands":[]},"lastUpdateStatusReason":{"schema":{"type":"object","properties":{"value":{"type":"string"}},"additionalProperties":false,"required":[]},"enumCommands":[]},"state":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["normalOperation","updateInProgress"]}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"checkForFirmwareUpdate":{"arguments":[]},"updateFirmware":{"arguments":[]}}},{"id":"colorTemperature","version":1,"status":"live","name":"Color Temperature","attributes":{"colorTemperature":{"schema":{"type":"object","properties":{"value":{"type":"integer","minimum":1,"maximum":30000},"unit":{"type":"string","enum":["K"],"default":"K"}},"additionalProperties":false,"required":["value"]},"setter":"setColorTemperature","enumCommands":[]}},"commands":{"setColorTemperature":{"arguments":[{"name":"temperature","optional":false,"schema":{"type":"integer","minimum":1,"maximum":30000}}]}}},{"id":"languageSetting","version":1,"status":"proposed","name":"Language Setting","attributes":{"supportedLanguages":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string"}}},"additionalProperties":false,"required":[]},"enumCommands":[]},"language":{"schema":{"type":"object","properties":{"value":{"type":"string"}},"additionalProperties":false,"required":[]},"setter":"setLanguage","enumCommands":[]}},"commands":{"setLanguage":{"arguments":[{"name":"language","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"geofences","version":1,"status":"deprecated","name":"Geofences","attributes":{"geofences":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"Geofence","type":"object","additionalProperties":false,"properties":{"id":{"title":"PositiveInteger","type":"integer","minimum":0},"presence":{"title":"PresenceState","type":"string","enum":["present","not present"]}}}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"colorMode","version":1,"status":"proposed","name":"Color Mode","attributes":{"colorMode":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["color","colorTemperature","other"]}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{}},{"id":"lock","version":1,"status":"live","name":"Lock","attributes":{"lock":{"schema":{"type":"object","properties":{"value":{"title":"LockState","type":"string","enum":["locked","unknown","unlocked","unlocked with timeout"]},"data":{"type":"object","additionalProperties":false,"required":[],"properties":{"method":{"type":"string","enum":["manual","keypad","auto","command","rfid","fingerprint","bluetooth"]},"codeId":{"type":"string"},"timeout":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}}}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"lock","value":"locked"},{"command":"unlock","value":"unlocked"}]}},"commands":{"lock":{"arguments":[]},"unlock":{"arguments":[]}}},{"id":"washerOperationalState","version":1,"status":"deprecated","name":"Washer Operational State","attributes":{"machineState":{"schema":{"type":"object","properties":{"value":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}},"additionalProperties":false,"required":["value"]},"setter":"setMachineState","enumCommands":[]},"supportedMachineStates":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]},"washerJobState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["airWash","cooling","delayWash","drying","finish","none","preWash","rinse","spin","wash","weightSensing","wrinklePrevent"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"completionTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"setMachineState":{"arguments":[{"name":"state","optional":false,"schema":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}}]}}},{"id":"alarmSystemArmOnly","version":1,"status":"dead","name":"Alarm System Arm Only","attributes":{"alarmSystemStatus":{"schema":{"type":"object","properties":{"value":{"title":"AlarmSystemState","type":"string","enum":["away","off","stay"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"sendEvent(alarmSystemStatus,stay)","value":"stay"},{"command":"sendEvent(alarmSystemStatus,away)","value":"away"}]}},"commands":{"sendEvent(alarmSystemStatus,stay)":{"arguments":[]},"sendEvent(alarmSystemStatus,away)":{"arguments":[]}}},{"id":"robotCleanerMovement","version":1,"status":"proposed","name":"Robot Cleaner Movement","attributes":{"robotCleanerMovement":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["homing","idle","charging","alarm","powerOff","reserve","point","after","cleaning","pause"]}},"additionalProperties":false,"required":["value"]},"setter":"setRobotCleanerMovement","enumCommands":[]}},"commands":{"setRobotCleanerMovement":{"arguments":[{"name":"mode","optional":false,"schema":{"type":"string","enum":["homing","idle","charging","alarm","powerOff","reserve","point","after","cleaning","pause"]}}]}}},{"id":"demandResponseLoadControl","version":1,"status":"proposed","name":"Demand Response Load Control","attributes":{"drlcStatus":{"schema":{"type":"object","properties":{"value":{"title":"DemandResponseLoadControlStatus","type":"object","additionalProperties":false,"properties":{"drlcType":{"title":"DrlcType","type":"integer","minimum":0,"maximum":1},"drlcLevel":{"title":"DrlcLevel","type":"integer","minimum":-1,"maximum":3},"start":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"},"duration":{"title":"PositiveInteger","type":"integer","minimum":0},"override":{"type":"boolean"}}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"requestDrlcAction":{"arguments":[{"name":"drlcType","optional":false,"schema":{"title":"DrlcType","type":"integer","minimum":0,"maximum":1}},{"name":"drlcLevel","optional":false,"schema":{"title":"DrlcLevel","type":"integer","minimum":-1,"maximum":3}},{"name":"start","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},{"name":"duration","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}},{"name":"reportingPeriod","optional":true,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]},"overrideDrlcAction":{"arguments":[{"name":"value","optional":false,"schema":{"type":"boolean"}}]}}},{"id":"audioVolume","version":1,"status":"live","name":"Audio Volume","attributes":{"volume":{"schema":{"title":"IntegerPercent","type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"additionalProperties":false,"required":["value"]},"setter":"setVolume","enumCommands":[]}},"commands":{"setVolume":{"arguments":[{"name":"volume","optional":false,"schema":{"type":"integer","minimum":0,"maximum":100}}]},"volumeUp":{"arguments":[]},"volumeDown":{"arguments":[]}}},{"id":"ovenMode","version":1,"status":"proposed","name":"Oven Mode","attributes":{"ovenMode":{"schema":{"type":"object","properties":{"value":{"title":"OvenMode","type":"string","enum":["heating","grill","warming","defrosting","Conventional","Bake","BottomHeat","ConvectionBake","ConvectionRoast","Broil","ConvectionBroil","SteamCook","SteamBake","SteamRoast","SteamBottomHeatplusConvection","Microwave","MWplusGrill","MWplusConvection","MWplusHotBlast","MWplusHotBlast2","SlimMiddle","SlimStrong","SlowCook","Proof","Dehydrate","Others"]}},"additionalProperties":false,"required":["value"]},"setter":"setOvenMode","enumCommands":[]},"supportedOvenModes":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"OvenMode","type":"string","enum":["heating","grill","warming","defrosting","Conventional","Bake","BottomHeat","ConvectionBake","ConvectionRoast","Broil","ConvectionBroil","SteamCook","SteamBake","SteamRoast","SteamBottomHeatplusConvection","Microwave","MWplusGrill","MWplusConvection","MWplusHotBlast","MWplusHotBlast2","SlimMiddle","SlimStrong","SlowCook","Proof","Dehydrate","Others"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setOvenMode":{"arguments":[{"name":"mode","optional":false,"schema":{"title":"OvenMode","type":"string","enum":["heating","grill","warming","defrosting","Conventional","Bake","BottomHeat","ConvectionBake","ConvectionRoast","Broil","ConvectionBroil","SteamCook","SteamBake","SteamRoast","SteamBottomHeatplusConvection","Microwave","MWplusGrill","MWplusConvection","MWplusHotBlast","MWplusHotBlast2","SlimMiddle","SlimStrong","SlowCook","Proof","Dehydrate","Others"]}}]}}},{"id":"fanSpeed","version":1,"status":"live","name":"Fan Speed","attributes":{"fanSpeed":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"setter":"setFanSpeed","enumCommands":[]}},"commands":{"setFanSpeed":{"arguments":[{"name":"speed","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]}}},{"id":"wifiMeshRouter","version":1,"status":"proposed","name":"Wifi Mesh Router","attributes":{"wifiNetworkName":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"wifiGuestNetworkName":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"connectedRouterCount":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"disconnectedRouterCount":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"connectedDeviceCount":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"wifiNetworkStatus":{"schema":{"type":"object","properties":{"value":{"title":"WifiState","type":"string","enum":["enabled","disabled","not configured"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"enableWifiNetwork","value":"enabled"},{"command":"disableWifiNetwork","value":"disabled"}]},"wifiGuestNetworkStatus":{"schema":{"type":"object","properties":{"value":{"title":"WifiState","type":"string","enum":["enabled","disabled","not configured"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"enableWifiGuestNetwork","value":"enabled"},{"command":"disableWifiGuestNetwork","value":"disabled"}]}},"commands":{"enableWifiNetwork":{"arguments":[]},"disableWifiNetwork":{"arguments":[]},"enableWifiGuestNetwork":{"arguments":[]},"disableWifiGuestNetwork":{"arguments":[]}}},{"id":"airQualitySensor","version":1,"status":"live","name":"Air Quality Sensor","attributes":{"airQuality":{"schema":{"type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":100},"unit":{"type":"string","enum":["CAQI"],"default":"CAQI"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"statelessAudioMuteButton","version":1,"status":"live","name":"Stateless Audio Mute Button","attributes":{"availableAudioMuteButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["muteToggle"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["muteToggle"]}}]}}},{"id":"tamperAlert","version":1,"status":"live","name":"Tamper Alert","attributes":{"tamper":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["clear","detected"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"videoCamera","version":1,"status":"live","name":"Video Camera","attributes":{"camera":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["off","on","restarting","unavailable"]}},"additionalProperties":false,"required":[]},"enumCommands":[{"command":"on","value":"on"},{"command":"off","value":"off"}]},"mute":{"schema":{"type":"object","properties":{"value":{"title":"MuteState","type":"string","enum":["muted","unmuted"]}},"additionalProperties":false,"required":[]},"enumCommands":[{"command":"mute","value":"muted"},{"command":"unmute","value":"unmuted"}]},"settings":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"statusMessage":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"flip":{"arguments":[]},"mute":{"arguments":[]},"off":{"arguments":[]},"on":{"arguments":[]},"unmute":{"arguments":[]}}},{"id":"windowShadePreset","version":1,"status":"live","name":"Window Shade Preset","attributes":{},"commands":{"presetPosition":{"arguments":[]}}},{"id":"garageDoorControl","version":1,"status":"deprecated","name":"Garage Door Control","attributes":{"door":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["closed","closing","open","opening","unknown"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"close","value":"closed"},{"command":"open","value":"open"}]}},"commands":{"close":{"arguments":[]},"open":{"arguments":[]}}},{"id":"dustSensor","version":1,"status":"live","name":"Dust Sensor","attributes":{"fineDustLevel":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0},"unit":{"type":"string","enum":["μg/m^3"],"default":"μg/m^3"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"dustLevel":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0},"unit":{"type":"string","enum":["μg/m^3"],"default":"μg/m^3"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"indicator","version":1,"status":"deprecated","name":"Indicator","attributes":{"indicatorStatus":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["never","when off","when on"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"indicatorNever","value":"never"},{"command":"indicatorWhenOff","value":"when off"},{"command":"indicatorWhenOn","value":"when on"}]}},"commands":{"indicatorNever":{"arguments":[]},"indicatorWhenOff":{"arguments":[]},"indicatorWhenOn":{"arguments":[]}}},{"id":"thermostatSchedule","version":1,"status":"deprecated","name":"Thermostat Schedule","attributes":{"schedule":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":[]},"setter":"setSchedule","enumCommands":[]}},"commands":{"setSchedule":{"arguments":[{"name":"schedule","optional":false,"schema":{"title":"JsonObject","type":"object"}}]}}},{"id":"robotCleanerCleaningMode","version":1,"status":"proposed","name":"Robot Cleaner Cleaning Mode","attributes":{"robotCleanerCleaningMode":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["auto","part","repeat","manual","stop","map"]}},"additionalProperties":false,"required":["value"]},"setter":"setRobotCleanerCleaningMode","enumCommands":[]}},"commands":{"setRobotCleanerCleaningMode":{"arguments":[{"name":"mode","optional":false,"schema":{"type":"string","enum":["auto","part","repeat","manual","stop"]}}]}}},{"id":"logTrigger","version":1,"status":"proposed","name":"Log Trigger","attributes":{"logState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["idle","inProgress"]}},"additionalProperties":false,"required":[]},"enumCommands":[]},"logRequestState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["idle","triggerRequired"]}},"additionalProperties":false,"required":[]},"enumCommands":[]},"logInfo":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"triggerLog":{"arguments":[]},"triggerLogWithLogInfo":{"arguments":[{"name":"logInfo","optional":false,"schema":{"title":"JsonObject","type":"object"}}]},"triggerLogWithUrl":{"arguments":[{"name":"url","optional":true,"schema":{"title":"URL","type":"string","pattern":"^(https?):\\/\\/((?:[a-zA-Z0-9.-]|%[0-9A-F]{2}){3,})(?::(\\d+))?((?:\\/(?:[a-z0-9-._~!$&'()*+,;=:@]|%[0-9A-F]{2})*)*)(?:\\?((?:[a-zA-Z0-9-._~!$&'()*+,;=:\\/?@]|%[0-9A-F]{2})*))?(?:#((?:[a-zA-Z0-9-._~!$&'()*+,;=:\\/?@]|%[0-9A-F]{2})*))?$"}}]}}},{"id":"audioMute","version":1,"status":"live","name":"Audio Mute","attributes":{"mute":{"schema":{"type":"object","properties":{"value":{"title":"MuteState","type":"string","enum":["muted","unmuted"]}},"additionalProperties":false,"required":["value"]},"setter":"setMute","enumCommands":[{"command":"mute","value":"muted"},{"command":"unmute","value":"unmuted"}]}},"commands":{"setMute":{"arguments":[{"name":"state","optional":false,"schema":{"title":"MuteState","type":"string","enum":["muted","unmuted"]}}]},"mute":{"arguments":[]},"unmute":{"arguments":[]}}},{"id":"ovenOperatingState","version":1,"status":"proposed","name":"Oven Operating State","attributes":{"machineState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["ready","running","paused"]}},"additionalProperties":false,"required":[]},"setter":"setMachineState","enumCommands":[]},"supportedMachineStates":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["ready","running","paused"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]},"ovenJobState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["cleaning","cooking","cooling","draining","preheat","ready","rinsing"]}},"additionalProperties":false,"required":[]},"enumCommands":[]},"completionTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"operationTime":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]},"progress":{"schema":{"title":"IntegerPercent","type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"setMachineState":{"arguments":[{"name":"state","optional":false,"schema":{"type":"string","enum":["stop"]}}]},"stop":{"arguments":[]},"start":{"arguments":[{"name":"mode","optional":true,"schema":{"title":"OvenMode","type":"string","enum":["heating","grill","warming","defrosting","Conventional","Bake","BottomHeat","ConvectionBake","ConvectionRoast","Broil","ConvectionBroil","SteamCook","SteamBake","SteamRoast","SteamBottomHeatplusConvection","Microwave","MWplusGrill","MWplusConvection","MWplusHotBlast","MWplusHotBlast2","SlimMiddle","SlimStrong","SlowCook","Proof","Dehydrate","Others"]}},{"name":"time","optional":true,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}},{"name":"setpoint","optional":true,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]}}},{"id":"relativeHumidityMeasurement","version":1,"status":"live","name":"Relative Humidity Measurement","attributes":{"humidity":{"schema":{"title":"Percent","type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"notification","version":1,"status":"live","name":"Notification","attributes":{},"commands":{"deviceNotification":{"arguments":[{"name":"notification","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"tvocHealthConcern","version":1,"status":"proposed","name":"Tvoc Health Concern","attributes":{"tvocHealthConcern":{"schema":{"type":"object","properties":{"value":{"title":"AirQualityHealthConcern","type":"string","enum":["good","moderate","slightlyUnhealthy","unhealthy","veryUnhealthy","hazardous"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"airConditionerMode","version":1,"status":"proposed","name":"Air Conditioner Mode","attributes":{"airConditionerMode":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"setter":"setAirConditionerMode","enumCommands":[]},"supportedAcModes":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string"}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setAirConditionerMode":{"arguments":[{"name":"mode","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"carbonDioxideHealthConcern","version":1,"status":"proposed","name":"Carbon Dioxide Health Concern","attributes":{"carbonDioxideHealthConcern":{"schema":{"type":"object","properties":{"value":{"title":"AirQualityHealthConcern","type":"string","enum":["good","moderate","slightlyUnhealthy","unhealthy","veryUnhealthy","hazardous"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"chime","version":1,"status":"proposed","name":"Chime","attributes":{"chime":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["chime","off"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"chime","value":"chime"},{"command":"off","value":"off"}]}},"commands":{"chime":{"arguments":[]},"off":{"arguments":[]}}},{"id":"thermostatCoolingSetpoint","version":1,"status":"live","name":"Thermostat Cooling Setpoint","attributes":{"coolingSetpoint":{"schema":{"title":"Temperature","type":"object","properties":{"value":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},"unit":{"type":"string","enum":["F","C"]}},"additionalProperties":false,"required":["value","unit"]},"setter":"setCoolingSetpoint","enumCommands":[]}},"commands":{"setCoolingSetpoint":{"arguments":[{"name":"setpoint","optional":false,"schema":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000}}]}}},{"id":"audioStream","version":1,"status":"live","name":"Audio Stream","attributes":{"uri":{"schema":{"type":"object","properties":{"value":{"title":"URI","type":"string","format":"uri"}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"startAudio":{"arguments":[]},"stopAudio":{"arguments":[]}}},{"id":"alarmSystem","version":1,"status":"dead","name":"Alarm System","attributes":{"alarmSystemStatus":{"schema":{"type":"object","properties":{"value":{"title":"AlarmSystemState","type":"string","enum":["away","off","stay"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"sendEvent(alarmSystemStatus,off)","value":"off"},{"command":"sendEvent(alarmSystemStatus,stay)","value":"stay"},{"command":"sendEvent(alarmSystemStatus,away)","value":"away"}]}},"commands":{"sendEvent(alarmSystemStatus,off)":{"arguments":[]},"sendEvent(alarmSystemStatus,stay)":{"arguments":[]},"sendEvent(alarmSystemStatus,away)":{"arguments":[]}}},{"id":"airConditionerFanMode","version":1,"status":"proposed","name":"Air Conditioner Fan Mode","attributes":{"fanMode":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"supportedAcFanModes":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string"}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setFanMode":{"arguments":[{"name":"fanMode","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"mediaPlaybackRepeat","version":1,"status":"proposed","name":"Media Playback Repeat","attributes":{"playbackRepeatMode":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["all","off","one"]}},"additionalProperties":false,"required":["value"]},"setter":"setPlaybackRepeatMode","enumCommands":[]}},"commands":{"setPlaybackRepeatMode":{"arguments":[{"name":"mode","optional":false,"schema":{"type":"string","enum":["all","off","one"]}}]}}},{"id":"bufferedVideoCapture","version":1,"status":"deprecated","name":"Buffered Video Capture","attributes":{"clip":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"capture":{"arguments":[{"name":"startTime","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},{"name":"captureTime","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},{"name":"endTime","optional":false,"schema":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}}]}}},{"id":"ultravioletIndex","version":1,"status":"live","name":"Ultraviolet Index","attributes":{"ultravioletIndex":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"shockSensor","version":1,"status":"deprecated","name":"Shock Sensor","attributes":{"shock":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["clear","detected"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"rapidCooling","version":1,"status":"proposed","name":"Rapid Cooling","attributes":{"rapidCooling":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["off","on"]}},"additionalProperties":false,"required":["value"]},"setter":"setRapidCooling","enumCommands":[]}},"commands":{"setRapidCooling":{"arguments":[{"name":"rapidCooling","optional":false,"schema":{"type":"string","enum":["off","on"]}}]}}},{"id":"fineDustSensor","version":1,"status":"live","name":"Fine Dust Sensor","attributes":{"fineDustLevel":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0},"unit":{"type":"string","enum":["μg/m^3"],"default":"μg/m^3"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"thermostatMode","version":1,"status":"live","name":"Thermostat Mode","attributes":{"thermostatMode":{"schema":{"type":"object","properties":{"value":{"title":"ThermostatMode","type":"string","enum":["asleep","auto","autowitheco","autowithreset","autochangeover","autochangeoveractive","autocool","autoheat","auxheatonly","auxiliaryemergencyheat","away","cool","custom","dayoff","dryair","eco","emergency heat","emergencyheat","emergencyheatactive","energysavecool","energysaveheat","fanonly","frostguard","furnace","heat","heatingoff","home","in","manual","moistair","off","out","resume","rush hour","rushhour","schedule","southernaway"]},"data":{"type":"object","additionalProperties":false,"required":[],"properties":{"supportedThermostatModes":{"type":"array","items":{"title":"ThermostatMode","type":"string","enum":["asleep","auto","autowitheco","autowithreset","autochangeover","autochangeoveractive","autocool","autoheat","auxheatonly","auxiliaryemergencyheat","away","cool","custom","dayoff","dryair","eco","emergency heat","emergencyheat","emergencyheatactive","energysavecool","energysaveheat","fanonly","frostguard","furnace","heat","heatingoff","home","in","manual","moistair","off","out","resume","rush hour","rushhour","schedule","southernaway"]}}}}},"additionalProperties":false,"required":["value"]},"setter":"setThermostatMode","enumCommands":[{"command":"auto","value":"auto"},{"command":"cool","value":"cool"},{"command":"emergencyHeat","value":"emergency heat"},{"command":"heat","value":"heat"},{"command":"off","value":"off"}]},"supportedThermostatModes":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"ThermostatMode","type":"string","enum":["asleep","auto","autowitheco","autowithreset","autochangeover","autochangeoveractive","autocool","autoheat","auxheatonly","auxiliaryemergencyheat","away","cool","custom","dayoff","dryair","eco","emergency heat","emergencyheat","emergencyheatactive","energysavecool","energysaveheat","fanonly","frostguard","furnace","heat","heatingoff","home","in","manual","moistair","off","out","resume","rush hour","rushhour","schedule","southernaway"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"auto":{"arguments":[]},"cool":{"arguments":[]},"emergencyHeat":{"arguments":[]},"heat":{"arguments":[]},"off":{"arguments":[]},"setThermostatMode":{"arguments":[{"name":"mode","optional":false,"schema":{"title":"ThermostatMode","type":"string","enum":["asleep","auto","autowitheco","autowithreset","autochangeover","autochangeoveractive","autocool","autoheat","auxheatonly","auxiliaryemergencyheat","away","cool","custom","dayoff","dryair","eco","emergency heat","emergencyheat","emergencyheatactive","energysavecool","energysaveheat","fanonly","frostguard","furnace","heat","heatingoff","home","in","manual","moistair","off","out","resume","rush hour","rushhour","schedule","southernaway"]}}]}}},{"id":"statelessRobotCleanerHomeButton","version":1,"status":"proposed","name":"Stateless Robot Cleaner Home Button","attributes":{"availableRobotCleanerHomeButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["home"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["home"]}}]}}},{"id":"washerMode","version":1,"status":"proposed","name":"Washer Mode","attributes":{"washerMode":{"schema":{"type":"object","properties":{"value":{"title":"WasherMode","type":"string","enum":["regular","heavy","rinse","spinDry"]}},"additionalProperties":false,"required":["value"]},"setter":"setWasherMode","enumCommands":[]}},"commands":{"setWasherMode":{"arguments":[{"name":"mode","optional":false,"schema":{"title":"WasherMode","type":"string","enum":["regular","heavy","rinse","spinDry"]}}]}}},{"id":"statelessTemperatureButton","version":1,"status":"live","name":"Stateless Temperature Button","attributes":{"availableTemperatureButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["temperatureUp","temperatureDown"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["temperatureUp","temperatureDown"]}}]}}},{"id":"gasDetector","version":1,"status":"proposed","name":"Gas Detector","attributes":{"gas":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["clear","detected","tested"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"imageCapture","version":1,"status":"live","name":"Image Capture","attributes":{"image":{"schema":{"type":"object","properties":{"value":{"title":"URL","type":"string","pattern":"^(https?):\\/\\/((?:[a-zA-Z0-9.-]|%[0-9A-F]{2}){3,})(?::(\\d+))?((?:\\/(?:[a-z0-9-._~!$&'()*+,;=:@]|%[0-9A-F]{2})*)*)(?:\\?((?:[a-zA-Z0-9-._~!$&'()*+,;=:\\/?@]|%[0-9A-F]{2})*))?(?:#((?:[a-zA-Z0-9-._~!$&'()*+,;=:\\/?@]|%[0-9A-F]{2})*))?$"}},"additionalProperties":false,"required":["value"]},"setter":"take","enumCommands":[]},"captureTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"take":{"arguments":[{"name":"correlationId","optional":true,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"reason","optional":true,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"fanOscillationMode","version":1,"status":"proposed","name":"Fan Oscillation Mode","attributes":{"fanOscillationMode":{"schema":{"type":"object","properties":{"value":{"title":"FanOscillationMode","type":"string","enum":["fixed","vertical","horizontal","all","indirect","direct","fixedCenter","fixedLeft","fixedRight","far"]}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setFanOscillationMode":{"arguments":[{"name":"fanOscillationMode","optional":false,"schema":{"title":"FanOscillationMode","type":"string","enum":["fixed","vertical","horizontal","all","indirect","direct","fixedCenter","fixedLeft","fixedRight","far"]}}]}}},{"id":"configuration","version":1,"status":"live","name":"Configuration","attributes":{},"commands":{"configure":{"arguments":[]}}},{"id":"ovenOperationalState","version":1,"status":"deprecated","name":"Oven Operational State","attributes":{"machineState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["ready","running","paused"]}},"additionalProperties":false,"required":[]},"setter":"setMachineState","enumCommands":[]},"supportedMachineStates":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["ready","running","paused"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]},"ovenJobState":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["cleaning","cooking","cooling","draining","preheat","ready","rinsing"]}},"additionalProperties":false,"required":[]},"enumCommands":[]},"completionTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"operationTime":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]},"progress":{"schema":{"title":"IntegerPercent","type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"setMachineState":{"arguments":[{"name":"state","optional":false,"schema":{"type":"string","enum":["stop"]}}]},"stop":{"arguments":[]}}},{"id":"valve","version":1,"status":"live","name":"Valve","attributes":{"valve":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["closed","open"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"close","value":"closed"},{"command":"open","value":"open"}]}},"commands":{"close":{"arguments":[]},"open":{"arguments":[]}}},{"id":"bypassable","version":1,"status":"live","name":"Bypassable","attributes":{"bypassStatus":{"schema":{"type":"object","properties":{"value":{"title":"BypassState","type":"string","enum":["ready","notReady","bypassed"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"veryFineDustSensor","version":1,"status":"live","name":"Very Fine Dust Sensor","attributes":{"veryFineDustLevel":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0},"unit":{"type":"string","enum":["μg/m^3"],"default":"μg/m^3"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"thermostatSetpoint","version":1,"status":"deprecated","name":"Thermostat Setpoint","attributes":{"thermostatSetpoint":{"schema":{"title":"Temperature","type":"object","properties":{"value":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},"unit":{"type":"string","enum":["F","C"]}},"additionalProperties":false,"required":["value","unit"]},"enumCommands":[]}},"commands":{}},{"id":"carbonDioxideMeasurement","version":1,"status":"live","name":"Carbon Dioxide Measurement","attributes":{"carbonDioxide":{"schema":{"type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":1000000},"unit":{"type":"string","enum":["ppm"],"default":"ppm"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"windowShadeLevel","version":1,"status":"proposed","name":"Window Shade Level","attributes":{"shadeLevel":{"schema":{"title":"IntegerPercent","type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"additionalProperties":false,"required":["value"]},"setter":"setShadeLevel","enumCommands":[]}},"commands":{"setShadeLevel":{"arguments":[{"name":"shadeLevel","optional":false,"schema":{"title":"IntegerPercent","type":"object","additionalProperties":false,"properties":{"value":{"type":"integer","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"required":["value"]}}]}}},{"id":"sleepSensor","version":1,"status":"live","name":"Sleep Sensor","attributes":{"sleeping":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["not sleeping","sleeping"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"drivingStatus","version":1,"status":"proposed","name":"Driving Status","attributes":{"drivingStatus":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["driving","notDriving"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"musicPlayer","version":1,"status":"deprecated","name":"Music Player","attributes":{"level":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"setter":"setLevel","enumCommands":[]},"mute":{"schema":{"type":"object","properties":{"value":{"title":"MuteState","type":"string","enum":["muted","unmuted"]}},"additionalProperties":false,"required":[]},"enumCommands":[{"command":"mute","value":"muted"},{"command":"unmute","value":"unmuted"}]},"status":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"trackData":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":[]},"enumCommands":[]},"trackDescription":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"mute":{"arguments":[]},"nextTrack":{"arguments":[]},"pause":{"arguments":[]},"play":{"arguments":[]},"playTrack":{"arguments":[{"name":"trackToPlay","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]},"previousTrack":{"arguments":[]},"restoreTrack":{"arguments":[{"name":"trackToRestore","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]},"resumeTrack":{"arguments":[{"name":"trackToResume","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]},"setLevel":{"arguments":[{"name":"level","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]},"setTrack":{"arguments":[{"name":"trackToSet","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]},"stop":{"arguments":[]},"unmute":{"arguments":[]}}},{"id":"contactSensor","version":1,"status":"live","name":"Contact Sensor","attributes":{"contact":{"schema":{"type":"object","properties":{"value":{"title":"ContactState","type":"string","enum":["closed","open"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"dishwasherOperationalState","version":1,"status":"deprecated","name":"Dishwasher Operational State","attributes":{"machineState":{"schema":{"type":"object","properties":{"value":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}},"additionalProperties":false,"required":["value"]},"setter":"setMachineState","enumCommands":[]},"supportedMachineStates":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"dishwasherJobState":{"schema":{"type":"object","properties":{"value":{"title":"DishwasherJobState","type":"string","enum":["airwash","cooling","drying","finish","preDrain","prewash","rinse","spin","unknown","wash","wrinklePrevent"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"completionTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"setMachineState":{"arguments":[{"name":"state","optional":false,"schema":{"title":"MachineState","type":"string","enum":["pause","run","stop"]}}]}}},{"id":"activitySensor","version":1,"status":"proposed","name":"Activity Sensor","attributes":{"activity":{"schema":{"type":"object","properties":{"value":{"title":"ActivityType","type":"string","enum":["noActivity","falling","lying","sitting","standing","eating"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"motionSensor","version":1,"status":"live","name":"Motion Sensor","attributes":{"motion":{"schema":{"type":"object","properties":{"value":{"title":"ActivityState","type":"string","enum":["active","inactive"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"radonHealthConcern","version":1,"status":"proposed","name":"Radon Health Concern","attributes":{"radonHealthConcern":{"schema":{"type":"object","properties":{"value":{"title":"AirQualityHealthConcern","type":"string","enum":["good","moderate","slightlyUnhealthy","unhealthy","veryUnhealthy","hazardous"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"sensor","version":1,"status":"deprecated","name":"Sensor","attributes":{},"commands":{}},{"id":"speechRecognition","version":1,"status":"proposed","name":"Speech Recognition","attributes":{"phraseSpoken":{"schema":{"type":"object","properties":{"value":{"type":"string","maxLength":1000}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"testCapability","version":1,"status":"live","name":"Test Capability","attributes":{},"commands":{}},{"id":"statelessFanspeedButton","version":1,"status":"live","name":"Stateless Fanspeed Button","attributes":{"availableFanspeedButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["fanspeedUp","fanspeedDown"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["fanspeedUp","fanspeedDown"]}}]}}},{"id":"windSpeed","version":1,"status":"proposed","name":"Wind Speed","attributes":{"windspeed":{"schema":{"type":"object","properties":{"value":{"title":"PositiveNumber","type":"number","minimum":0},"unit":{"type":"string","enum":["m/s"],"default":"m/s"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"statelessRobotCleanerActionButton","version":1,"status":"proposed","name":"Stateless Robot Cleaner Action Button","attributes":{"availableRobotCleanerActionButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["start","stop","quit"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["start","stop","quit"]}}]}}},{"id":"energyMeter","version":1,"status":"live","name":"Energy Meter","attributes":{"energy":{"schema":{"type":"object","properties":{"value":{"type":"number"},"unit":{"type":"string","enum":["Wh","kWh","mWh"],"default":"kWh"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"powerMeter","version":1,"status":"live","name":"Power Meter","attributes":{"power":{"schema":{"type":"object","properties":{"value":{"type":"number"},"unit":{"type":"string","enum":["W"],"default":"W"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"cameraPreset","version":1,"status":"proposed","name":"Camera Preset","attributes":{"presets":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"Camera Preset","type":"object","additionalProperties":false,"properties":{"name":{"type":"string"},"id":{"type":"string"},"data":{"title":"JsonObject","type":"object"}},"required":["name","id","data"]}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"execute":{"arguments":[{"name":"id","optional":false,"schema":{"type":"string"}}]},"create":{"arguments":[{"name":"name","optional":false,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"id","optional":true,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"data","optional":true,"schema":{"title":"JsonObject","type":"object"}}]},"delete":{"arguments":[{"name":"id","optional":false,"schema":{"type":"string"}}]},"update":{"arguments":[{"name":"id","optional":false,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"name","optional":true,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"data","optional":true,"schema":{"title":"JsonObject","type":"object"}}]}}},{"id":"filterState","version":1,"status":"live","name":"Filter State","attributes":{"filterLifeRemaining":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"fineDustHealthConcern","version":1,"status":"proposed","name":"Fine Dust Health Concern","attributes":{"fineDustHealthConcern":{"schema":{"type":"object","properties":{"value":{"title":"AirQualityHealthConcern","type":"string","enum":["good","moderate","slightlyUnhealthy","unhealthy","veryUnhealthy","hazardous"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"thermostatHeatingSetpoint","version":1,"status":"live","name":"Thermostat Heating Setpoint","attributes":{"heatingSetpoint":{"schema":{"title":"Temperature","type":"object","properties":{"value":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},"unit":{"type":"string","enum":["F","C"]}},"additionalProperties":false,"required":["value","unit"]},"setter":"setHeatingSetpoint","enumCommands":[]}},"commands":{"setHeatingSetpoint":{"arguments":[{"name":"setpoint","optional":false,"schema":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000}}]}}},{"id":"pestControl","version":1,"status":"proposed","name":"Pest Control","attributes":{"pestControl":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["idle","trapArmed","trapRearmRequired","pestDetected","pestExterminated"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"soundPressureLevel","version":1,"status":"live","name":"Sound Pressure Level","attributes":{"soundPressureLevel":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":194},"unit":{"type":"string","enum":["dB"],"default":"dB"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"switchLevel","version":1,"status":"live","name":"Switch Level","attributes":{"level":{"schema":{"title":"IntegerPercent","type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"additionalProperties":false,"required":["value"]},"setter":"setLevel","enumCommands":[]}},"commands":{"setLevel":{"arguments":[{"name":"level","optional":false,"schema":{"type":"integer","minimum":0,"maximum":100}},{"name":"rate","optional":true,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]}}},{"id":"videoClips","version":1,"status":"proposed","name":"Video Clips","attributes":{"videoClip":{"schema":{"type":"object","properties":{"value":{"title":"VideoClip","type":"object","additionalProperties":false,"properties":{"status":{"title":"VideoClipStatus","type":"string","enum":["initiated","streaming","completed","failed","ignored"]},"clipId":{"title":"String","type":"string","maxLength":255},"thumbnailUrl":{"title":"URL","type":"string","pattern":"^(https?):\\/\\/((?:[a-zA-Z0-9.-]|%[0-9A-F]{2}){3,})(?::(\\d+))?((?:\\/(?:[a-z0-9-._~!$&'()*+,;=:@]|%[0-9A-F]{2})*)*)(?:\\?((?:[a-zA-Z0-9-._~!$&'()*+,;=:\\/?@]|%[0-9A-F]{2})*))?(?:#((?:[a-zA-Z0-9-._~!$&'()*+,;=:\\/?@]|%[0-9A-F]{2})*))?$"},"clipUrl":{"title":"URL","type":"string","pattern":"^(https?):\\/\\/((?:[a-zA-Z0-9.-]|%[0-9A-F]{2}){3,})(?::(\\d+))?((?:\\/(?:[a-z0-9-._~!$&'()*+,;=:@]|%[0-9A-F]{2})*)*)(?:\\?((?:[a-zA-Z0-9-._~!$&'()*+,;=:\\/?@]|%[0-9A-F]{2})*))?(?:#((?:[a-zA-Z0-9-._~!$&'()*+,;=:\\/?@]|%[0-9A-F]{2})*))?$"},"startTime":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"},"captureTime":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"},"duration":{"title":"PositiveInteger","type":"integer","minimum":0}}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"captureClip":{"arguments":[{"name":"duration","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}},{"name":"preFetch","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]}}},{"id":"soundSensor","version":1,"status":"live","name":"Sound Sensor","attributes":{"sound":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["detected","not detected"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"humidifierMode","version":1,"status":"proposed","name":"Humidifier Mode","attributes":{"humidifierMode":{"schema":{"type":"object","properties":{"value":{"title":"HumidifierMode","type":"string","enum":["auto","low","medium","high"]}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setHumidifierMode":{"arguments":[{"name":"humidifierMode","optional":false,"schema":{"title":"HumidifierMode","type":"string","enum":["auto","low","medium","high"]}}]}}},{"id":"windowShade","version":1,"status":"live","name":"Window Shade","attributes":{"windowShade":{"schema":{"type":"object","properties":{"value":{"title":"OpenableState","type":"string","enum":["closed","closing","open","opening","partially open","unknown"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"close","value":"closed"},{"command":"open","value":"open"}]},"supportedWindowShadeCommands":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["open","close","pause"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"close":{"arguments":[]},"open":{"arguments":[]},"pause":{"arguments":[]}}},{"id":"mediaPresets","version":1,"status":"proposed","name":"Media Presets","attributes":{"presets":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"MediaPreset","type":"object","additionalProperties":false,"properties":{"id":{"type":"string"},"name":{"type":"string"},"mediaSource":{"type":"string"},"imageUrl":{"type":"string"}},"required":["id","name"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"playPreset":{"arguments":[{"name":"presetId","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"networkMeter","version":1,"status":"live","name":"Network Meter","attributes":{"uplinkSpeed":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"downlinkSpeed":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"touchSensor","version":1,"status":"deprecated","name":"Touch Sensor","attributes":{"touch":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["touched"]}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{}},{"id":"execute","version":1,"status":"live","name":"Execute","attributes":{"data":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"},"data":{"type":"object","additionalProperties":true,"required":[]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"execute":{"arguments":[{"name":"command","optional":false,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"args","optional":true,"schema":{"title":"JsonObject","type":"object"}}]}}},{"id":"formaldehydeMeasurement","version":1,"status":"live","name":"Formaldehyde Measurement","attributes":{"formaldehydeLevel":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":1000000},"unit":{"type":"string","enum":["ppm","mg/m^3"],"default":"ppm"}},"additionalProperties":false,"required":["value","unit"]},"enumCommands":[]}},"commands":{}},{"id":"scent","version":1,"status":"proposed","name":"Scent","attributes":{"scentName":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"scentIntensity":{"schema":{"title":"IntegerPercent","type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"additionalProperties":false,"required":["value"]},"setter":"setScentIntensity","enumCommands":[]}},"commands":{"setScentIntensity":{"arguments":[{"name":"intensity","optional":false,"schema":{"type":"integer","minimum":0,"maximum":100}}]}}},{"id":"illuminanceMeasurement","version":1,"status":"live","name":"Illuminance Measurement","attributes":{"illuminance":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":100000},"unit":{"type":"string","enum":["lux"],"default":"lux"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"mediaPlayback","version":1,"status":"proposed","name":"Media Playback","attributes":{"playbackStatus":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["paused","playing","stopped","fast forwarding","rewinding"]}},"additionalProperties":false,"required":[]},"setter":"setPlaybackStatus","enumCommands":[{"command":"play","value":"playing"},{"command":"pause","value":"paused"},{"command":"stop","value":"stopped"},{"command":"fastForward","value":"fast forwarding"},{"command":"rewind","value":"rewinding"}]},"supportedPlaybackCommands":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"MediaPlaybackCommands","type":"string","enum":["pause","play","stop","fastForward","rewind"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setPlaybackStatus":{"arguments":[{"name":"status","optional":false,"schema":{"type":"string","enum":["paused","playing","stopped","fast forwarding","rewinding"]}}]},"play":{"arguments":[]},"pause":{"arguments":[]},"stop":{"arguments":[]},"fastForward":{"arguments":[]},"rewind":{"arguments":[]}}},{"id":"threeAxis","version":1,"status":"live","name":"Three Axis","attributes":{"threeAxis":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"integer","minimum":-10000,"maximum":10000},"minItems":3,"maxItems":3},"unit":{"type":"string","enum":["mG"],"default":"mG"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"statelessMediaPlaybackButton","version":1,"status":"proposed","name":"Stateless Media Playback Button","attributes":{"availableMediaPlaybackButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"MediaPlaybackCommands","type":"string","enum":["pause","play","stop","fastForward","rewind"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"title":"MediaPlaybackCommands","type":"string","enum":["pause","play","stop","fastForward","rewind"]}}]}}},{"id":"statelessChannelButton","version":1,"status":"live","name":"Stateless Channel Button","attributes":{"availableChannelButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["channelUp","channelDown"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["channelUp","channelDown"]}}]}}},{"id":"bulb","version":1,"status":"dead","name":"Bulb","attributes":{"switch":{"schema":{"type":"object","properties":{"value":{"title":"SwitchState","type":"string","enum":["on","off"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"off","value":"off"},{"command":"on","value":"on"}]}},"commands":{"off":{"arguments":[]},"on":{"arguments":[]}}},{"id":"odorSensor","version":1,"status":"proposed","name":"Odor Sensor","attributes":{"odorLevel":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"samsungTV","version":1,"status":"live","name":"Samsung TV","attributes":{"messageButton":{"schema":{"type":"object","properties":{"value":{"title":"JsonObject","type":"object"}},"additionalProperties":false,"required":[]},"enumCommands":[]},"mute":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["muted","unknown","unmuted"]}},"additionalProperties":false,"required":[]},"enumCommands":[{"command":"mute","value":"muted"},{"command":"unmute","value":"unmuted"}]},"pictureMode":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["dynamic","movie","standard","unknown"]}},"additionalProperties":false,"required":[]},"setter":"setPictureMode","enumCommands":[]},"soundMode":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["clear voice","movie","music","standard","unknown"]}},"additionalProperties":false,"required":[]},"setter":"setSoundMode","enumCommands":[]},"switch":{"schema":{"type":"object","properties":{"value":{"title":"SwitchState","type":"string","enum":["on","off"]}},"additionalProperties":false,"required":[]},"enumCommands":[{"command":"on","value":"on"},{"command":"off","value":"off"}]},"volume":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"setter":"setVolume","enumCommands":[]}},"commands":{"mute":{"arguments":[]},"off":{"arguments":[]},"on":{"arguments":[]},"setPictureMode":{"arguments":[{"name":"pictureMode","optional":false,"schema":{"type":"string","enum":["dynamic","movie","standard"]}}]},"setSoundMode":{"arguments":[{"name":"soundMode","optional":false,"schema":{"type":"string","enum":["clear voice","movie","music","standard"]}}]},"setVolume":{"arguments":[{"name":"volume","optional":false,"schema":{"title":"PositiveInteger","type":"integer","minimum":0}}]},"showMessage":{"arguments":[{"name":"1","optional":false,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"2","optional":false,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"3","optional":false,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"4","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]},"unmute":{"arguments":[]},"volumeDown":{"arguments":[]},"volumeUp":{"arguments":[]}}},{"id":"tV","version":1,"status":"live","name":"TV","attributes":{"channel":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]},"movieMode":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"picture":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"power":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"sound":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"volume":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"channelDown":{"arguments":[]},"channelUp":{"arguments":[]},"volumeDown":{"arguments":[]},"volumeUp":{"arguments":[]}}},{"id":"astronomicalData","version":1,"status":"dead","name":"Astronomical Data","attributes":{"sunrise":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["true"]}},"additionalProperties":false,"required":["value"]},"setter":"sendEvent(sunrise)","enumCommands":[]},"sunset":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["true"]}},"additionalProperties":false,"required":["value"]},"setter":"sendEvent(sunset)","enumCommands":[]},"sunriseTime":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"setter":"sendEvent(sunriseTime)","enumCommands":[]},"sunsetTime":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"setter":"sendEvent(sunsetTime)","enumCommands":[]}},"commands":{"sendEvent(sunrise)":{"arguments":[]},"sendEvent(sunset)":{"arguments":[]},"sendEvent(sunriseTime)":{"arguments":[]},"sendEvent(sunsetTime)":{"arguments":[]}}},{"id":"momentary","version":1,"status":"live","name":"Momentary","attributes":{},"commands":{"push":{"arguments":[]}}},{"id":"healthCheck","version":1,"status":"live","name":"Health Check","attributes":{"checkInterval":{"schema":{"type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":604800},"unit":{"type":"string","enum":["s"],"default":"s"},"data":{"type":"object","additionalProperties":false,"required":[],"properties":{"deviceScheme":{"type":"string","enum":["MIXED","TRACKED","UNTRACKED"]},"hubHardwareId":{"type":"string","pattern":"^[0-9a-fA-F]{4}$"},"protocol":{"title":"DeviceHealthProtocol","type":"string","enum":["zigbee","zwave","bluetooth","lan","cloud","unknown","ocf","mqtt"]},"offlinePingable":{"type":"string","enum":["0","1"]},"badProperty":{"type":"string"}}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"DeviceWatch-DeviceStatus":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["online","offline"]},"data":{"type":"object","additionalProperties":false,"required":[],"properties":{"deviceScheme":{"type":"string","enum":["MIXED","TRACKED","UNTRACKED"]},"badProperty":{"type":"string"}}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"healthStatus":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["online","offline"]},"data":{"type":"object","additionalProperties":false,"required":[],"properties":{"deviceScheme":{"type":"string","enum":["MIXED","TRACKED","UNTRACKED"]},"badProperty":{"type":"string"}}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"DeviceWatch-Enroll":{"schema":{"type":"object","properties":{"value":{"title":"DeviceHealthEnroll","type":"object","additionalProperties":false,"properties":{"scheme":{"type":"string","enum":["MIXED","TRACKED","UNTRACKED"]},"protocol":{"title":"DeviceHealthProtocol","type":"string","enum":["zigbee","zwave","bluetooth","lan","cloud","unknown","ocf","mqtt"]},"hubHardwareId":{"title":"String","type":"string","maxLength":255}}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"ping":{"arguments":[]}}},{"id":"statelessHumidifierModeButton","version":1,"status":"proposed","name":"Stateless Humidifier Mode Button","attributes":{"availableHumidifierModeButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["changeMode"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["changeMode"]}}]}}},{"id":"ocf","version":1,"status":"proposed","name":"Ocf","attributes":{"n":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"icv":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"dmv":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"di":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"pi":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"mnmn":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"mnml":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"mnmo":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"mndt":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"mnpv":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"mnos":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"mnhw":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"mnfv":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"mnsl":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"st":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"vid":{"schema":{"title":"StringAttribute","type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{"postOcfCommand":{"arguments":[{"name":"href","optional":false,"schema":{"title":"String","type":"string","maxLength":255}},{"name":"value","optional":false,"schema":{"title":"JsonObject","type":"object"}}]}}},{"id":"waterSensor","version":1,"status":"live","name":"Water Sensor","attributes":{"water":{"schema":{"type":"object","properties":{"value":{"title":"MoistureState","type":"string","enum":["dry","wet"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"statelessCustomButton","version":1,"status":"live","name":"Stateless Custom Button","attributes":{"availableCustomButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string"}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string"}}]}}},{"id":"alarm","version":1,"status":"live","name":"Alarm","attributes":{"alarm":{"schema":{"type":"object","properties":{"value":{"title":"AlertState","type":"string","enum":["both","off","siren","strobe"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"both","value":"both"},{"command":"off","value":"off"},{"command":"siren","value":"siren"},{"command":"strobe","value":"strobe"}]}},"commands":{"both":{"arguments":[]},"off":{"arguments":[]},"siren":{"arguments":[]},"strobe":{"arguments":[]}}},{"id":"relaySwitch","version":1,"status":"deprecated","name":"Relay Switch","attributes":{"switch":{"schema":{"type":"object","properties":{"value":{"title":"SwitchState","type":"string","enum":["on","off"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"on","value":"on"},{"command":"off","value":"off"}]}},"commands":{"off":{"arguments":[]},"on":{"arguments":[]}}},{"id":"actuator","version":1,"status":"deprecated","name":"Actuator","attributes":{},"commands":{}},{"id":"dustHealthConcern","version":1,"status":"proposed","name":"Dust Health Concern","attributes":{"dustHealthConcern":{"schema":{"type":"object","properties":{"value":{"title":"AirQualityHealthConcern","type":"string","enum":["good","moderate","slightlyUnhealthy","unhealthy","veryUnhealthy","hazardous"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"airPurifierFanMode","version":1,"status":"proposed","name":"Air Purifier Fan Mode","attributes":{"airPurifierFanMode":{"schema":{"type":"object","properties":{"value":{"title":"AirPurifierFanMode","type":"string","enum":["auto","sleep","low","medium","high","quiet","windFree"]}},"additionalProperties":false,"required":[]},"enumCommands":[]},"supportedAirPurifierFanModes":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["auto","sleep","low","medium","high","quiet","windFree"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setAirPurifierFanMode":{"arguments":[{"name":"airPurifierFanMode","optional":false,"schema":{"title":"AirPurifierFanMode","type":"string","enum":["auto","sleep","low","medium","high","quiet","windFree"]}}]}}},{"id":"geolocation","version":1,"status":"proposed","name":"Geolocation","attributes":{"latitude":{"schema":{"type":"object","properties":{"value":{"type":"integer","maximum":90,"minimum":-90}},"additionalProperties":false,"required":[]},"enumCommands":[]},"longitude":{"schema":{"type":"object","properties":{"value":{"type":"integer","maximum":180,"minimum":-180}},"additionalProperties":false,"required":[]},"enumCommands":[]},"method":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"accuracy":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]},"altitudeAccuracy":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]},"heading":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":360}},"additionalProperties":false,"required":[]},"enumCommands":[]},"speed":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]},"lastUpdateTime":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{}},{"id":"powerConsumptionReport","version":1,"status":"proposed","name":"Power Consumption Report","attributes":{"powerConsumption":{"schema":{"type":"object","properties":{"value":{"title":"PowerConsumption","type":"object","additionalProperties":false,"properties":{"start":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"},"end":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"},"energy":{"type":"number"},"power":{"type":"number"},"deltaEnergy":{"type":"number"},"powerEnergy":{"type":"number"},"energySaved":{"type":"number"},"persistedEnergy":{"type":"number"}}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"objectDetection","version":1,"status":"live","name":"Object Detection","attributes":{"detected":{"schema":{"type":"object","properties":{"value":{"title":"ObjectDetectionValue","type":"object","additionalProperties":false,"properties":{"value":{"title":"String","type":"string","maxLength":255},"qty":{"title":"PositiveInteger","type":"integer","minimum":0},"data":{"title":"JsonObject","type":"object"}},"required":["value"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"supportedValues":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"String","type":"string","maxLength":255}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{}},{"id":"refrigeration","version":1,"status":"live","name":"Refrigeration","attributes":{"rapidCooling":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["off","on"]}},"additionalProperties":false,"required":[]},"setter":"setRapidCooling","enumCommands":[]},"rapidFreezing":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["off","on"]}},"additionalProperties":false,"required":[]},"setter":"setRapidFreezing","enumCommands":[]},"defrost":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["off","on"]}},"additionalProperties":false,"required":[]},"setter":"setDefrost","enumCommands":[]}},"commands":{"setRapidCooling":{"arguments":[{"name":"rapidCooling","optional":false,"schema":{"type":"string","enum":["off","on"]}}]},"setRapidFreezing":{"arguments":[{"name":"rapidCooling","optional":false,"schema":{"type":"string","enum":["off","on"]}}]},"setDefrost":{"arguments":[{"name":"rapidCooling","optional":false,"schema":{"type":"string","enum":["off","on"]}}]}}},{"id":"lockOnly","version":1,"status":"deprecated","name":"Lock Only","attributes":{"lock":{"schema":{"type":"object","properties":{"value":{"title":"LockState","type":"string","enum":["locked","unknown","unlocked","unlocked with timeout"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[{"command":"lock","value":"locked"}]}},"commands":{"lock":{"arguments":[]}}},{"id":"dryerMode","version":1,"status":"proposed","name":"Dryer Mode","attributes":{"dryerMode":{"schema":{"type":"object","properties":{"value":{"title":"DryerMode","type":"string","enum":["regular","lowHeat","highHeat"]}},"additionalProperties":false,"required":["value"]},"setter":"setDryerMode","enumCommands":[]}},"commands":{"setDryerMode":{"arguments":[{"name":"mode","optional":false,"schema":{"title":"DryerMode","type":"string","enum":["regular","lowHeat","highHeat"]}}]}}},{"id":"audioNotification","version":1,"status":"live","name":"Audio Notification","attributes":{},"commands":{"playTrack":{"arguments":[{"name":"uri","optional":false,"schema":{"title":"URI","type":"string","format":"uri"}},{"name":"level","optional":true,"schema":{"type":"integer","minimum":0,"maximum":100}}]},"playTrackAndResume":{"arguments":[{"name":"uri","optional":false,"schema":{"title":"URI","type":"string","format":"uri"}},{"name":"level","optional":true,"schema":{"type":"integer","minimum":0,"maximum":100}}]},"playTrackAndRestore":{"arguments":[{"name":"uri","optional":false,"schema":{"title":"URI","type":"string","format":"uri"}},{"name":"level","optional":true,"schema":{"type":"integer","minimum":0,"maximum":100}}]}}},{"id":"refrigerationSetpoint","version":1,"status":"proposed","name":"Refrigeration Setpoint","attributes":{"refrigerationSetpoint":{"schema":{"title":"Temperature","type":"object","properties":{"value":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},"unit":{"type":"string","enum":["F","C"]}},"additionalProperties":false,"required":["value","unit"]},"setter":"setRefrigerationSetpoint","enumCommands":[]}},"commands":{"setRefrigerationSetpoint":{"arguments":[{"name":"setpoint","optional":false,"schema":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000}}]}}},{"id":"pHMeasurement","version":1,"status":"live","name":"pH Measurement","attributes":{"pH":{"schema":{"type":"object","properties":{"value":{"type":"number","minimum":0,"maximum":14},"unit":{"type":"string","enum":["pH"],"default":"pH"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"temperatureAlarm","version":1,"status":"live","name":"Temperature Alarm","attributes":{"temperatureAlarm":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["cleared","freeze","heat","rateOfRise"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"temperatureMeasurement","version":1,"status":"live","name":"Temperature Measurement","attributes":{"temperature":{"schema":{"type":"object","properties":{"value":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},"unit":{"type":"string","enum":["F","C"]}},"additionalProperties":false,"required":["value","unit"]},"enumCommands":[]}},"commands":{}},{"id":"thermostatFanMode","version":1,"status":"live","name":"Thermostat Fan Mode","attributes":{"thermostatFanMode":{"schema":{"type":"object","properties":{"value":{"title":"ThermostatFanMode","type":"string","enum":["auto","circulate","followschedule","on"]},"data":{"type":"object","additionalProperties":false,"required":[],"properties":{"supportedThermostatFanModes":{"type":"array","items":{"title":"ThermostatFanMode","type":"string","enum":["auto","circulate","followschedule","on"]}}}}},"additionalProperties":false,"required":["value"]},"setter":"setThermostatFanMode","enumCommands":[{"command":"fanAuto","value":"auto"},{"command":"fanCirculate","value":"circulate"},{"command":"fanOn","value":"on"}]},"supportedThermostatFanModes":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"title":"ThermostatFanMode","type":"string","enum":["auto","circulate","followschedule","on"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"fanAuto":{"arguments":[]},"fanCirculate":{"arguments":[]},"fanOn":{"arguments":[]},"setThermostatFanMode":{"arguments":[{"name":"mode","optional":false,"schema":{"title":"ThermostatFanMode","type":"string","enum":["auto","circulate","followschedule","on"]}}]}}},{"id":"filterStatus","version":1,"status":"proposed","name":"Filter Status","attributes":{"filterStatus":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["normal","replace"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"mediaGroup","version":1,"status":"proposed","name":"Media Group","attributes":{"groupRole":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["primary","auxilary","ungrouped"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"groupPrimaryDeviceId":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"groupId":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"groupVolume":{"schema":{"title":"IntegerPercent","type":"object","properties":{"value":{"type":"integer","minimum":0,"maximum":100},"unit":{"type":"string","enum":["%"],"default":"%"}},"additionalProperties":false,"required":["value"]},"setter":"setGroupVolume","enumCommands":[]},"groupMute":{"schema":{"type":"object","properties":{"value":{"title":"MuteState","type":"string","enum":["muted","unmuted"]}},"additionalProperties":false,"required":["value"]},"setter":"setGroupMute","enumCommands":[{"command":"muteGroup","value":"muted"},{"command":"unmuteGroup","value":"unmuted"}]}},"commands":{"setGroupVolume":{"arguments":[{"name":"groupVolume","optional":false,"schema":{"type":"integer","minimum":0,"maximum":100}}]},"groupVolumeUp":{"arguments":[]},"groupVolumeDown":{"arguments":[]},"setGroupMute":{"arguments":[{"name":"state","optional":false,"schema":{"title":"MuteState","type":"string","enum":["muted","unmuted"]}}]},"muteGroup":{"arguments":[]},"unmuteGroup":{"arguments":[]}}},{"id":"carbonMonoxideDetector","version":1,"status":"live","name":"Carbon Monoxide Detector","attributes":{"carbonMonoxide":{"schema":{"type":"object","properties":{"value":{"title":"CarbonMonoxideState","type":"string","enum":["clear","detected","tested"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"dewPoint","version":1,"status":"proposed","name":"Dew Point","attributes":{"dewpoint":{"schema":{"type":"object","properties":{"value":{"title":"TemperatureValue","type":"number","minimum":-460,"maximum":10000},"unit":{"type":"string","enum":["F","C"]}},"additionalProperties":false,"required":["value","unit"]},"enumCommands":[]}},"commands":{}},{"id":"powerSource","version":1,"status":"live","name":"Power Source","attributes":{"powerSource":{"schema":{"type":"object","properties":{"value":{"type":"string","enum":["battery","dc","mains","unknown"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"statelessAirCleanerModeButton","version":1,"status":"proposed","name":"Stateless Air Cleaner Mode Button","attributes":{"availableAirCleanerModeButtons":{"schema":{"type":"object","properties":{"value":{"type":"array","items":{"type":"string","enum":["changeMode"]}}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"setButton":{"arguments":[{"name":"button","optional":false,"schema":{"type":"string","enum":["changeMode"]}}]}}},{"id":"veryFineDustHealthConcern","version":1,"status":"proposed","name":"Very Fine Dust Health Concern","attributes":{"veryFineDustHealthConcern":{"schema":{"type":"object","properties":{"value":{"title":"AirQualityHealthConcern","type":"string","enum":["good","moderate","slightlyUnhealthy","unhealthy","veryUnhealthy","hazardous"]}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"stepSensor","version":1,"status":"proposed","name":"Step Sensor","attributes":{"goal":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"steps":{"schema":{"type":"object","properties":{"value":{"title":"PositiveInteger","type":"integer","minimum":0}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}},{"id":"zwMultichannel","version":1,"status":"live","name":"Zw Multichannel","attributes":{"epEvent":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]},"epInfo":{"schema":{"type":"object","properties":{"value":{"title":"String","type":"string","maxLength":255}},"additionalProperties":false,"required":[]},"enumCommands":[]}},"commands":{"enableEpEvents":{"arguments":[{"name":"enabledEndpoints","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]},"epCmd":{"arguments":[{"name":"endpoint","optional":false,"schema":{"title":"Number","type":"number"}},{"name":"commands","optional":false,"schema":{"title":"String","type":"string","maxLength":255}}]}}},{"id":"gasMeter","version":1,"status":"proposed","name":"Gas Meter","attributes":{"gasMeterVolume":{"schema":{"type":"object","properties":{"value":{"type":"number"},"unit":{"type":"string","enum":["m^3"],"default":"m^3"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"gasMeter":{"schema":{"type":"object","properties":{"value":{"type":"number"},"unit":{"type":"string","enum":["kWh"],"default":"kWh"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"gasMeterCalorific":{"schema":{"type":"object","properties":{"value":{"type":"number"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"gasMeterConversion":{"schema":{"type":"object","properties":{"value":{"type":"number"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"gasMeterPrecision":{"schema":{"type":"object","properties":{"value":{"title":"GasMeterPrecision","type":"object","additionalProperties":false,"properties":{"volume":{"title":"VolumePrecision","type":"number"},"calorific":{"title":"CalorificPrecision","type":"number"},"conversion":{"title":"ConversionPrecision","type":"number"}}}},"additionalProperties":false,"required":["value"]},"enumCommands":[]},"gasMeterTime":{"schema":{"type":"object","properties":{"value":{"title":"Iso8601Date","type":"string","pattern":"^(?:[1-9]\\d{3}-?(?:(?:0[1-9]|1[0-2])-?(?:0[1-9]|1\\d|2[0-8])|(?:0[13-9]|1[0-2])-?(?:29|30)|(?:0[13578]|1[02])-?31)|(?:[1-9]\\d(?:0[48]|[2468][048]|[13579][26])|(?:[2468][048]|[13579][26])00)-?02-?29)T(?:[01]\\d|2[0-3]):?[0-5]\\d:?[0-5]\\d(?:\\.\\d{3})?(?:Z|[+-][01]\\d(?::?[0-5]\\d)?)$"}},"additionalProperties":false,"required":["value"]},"enumCommands":[]}},"commands":{}}]
        var _capabilities = {}
        _raw_capabilities.sort((capa1, capa2)=>{
                return capa1.id.localeCompare(capa2.id)
            })
            .forEach(function (cp) {
                if (cp.status === 'live' || cp.status === 'proposed') {
                    cp['vid']=cp.id+'_v'+cp.version //vid : id + version
                    cp['vname']=(cp.version===1?cp.name:cp.name+' v'+cp.version)// vname : name + version
                    // _capabilities[capa.id] = capa
                    _capabilities[cp.vid] = cp
                }
            })

        this.getAttributeSchema = function (capabilityId, attributeId) {
            if (_capabilities[capabilityId] && _capabilities[capabilityId].attributes && _capabilities[capabilityId].attributes[attributeId]) {
                return _capabilities[capabilityId].attributes[attributeId].schema || {}
            } else {
                return {}
            }
        }
        this.getCommandArguments = function (capabilityId, commandId) {
            if (_capabilities[capabilityId] && _capabilities[capabilityId].commands && _capabilities[capabilityId].commands[commandId]) {
                return _capabilities[capabilityId].commands[commandId].arguments || []
            } else {
                return []
            }
        }

        this.getCapability = function (vid) {
            if(vid&&vid.indexOf('_v')===-1){
                vid+='_v1'
            }
            return _capabilities[vid] || null
        }
        this.hasCapability = function (vid){
            if(vid&&vid.indexOf('_v')===-1){
                vid+='_v1'
            }
            return !!_capabilities[vid]
        }
        this.getAllCapabilities = function () {
            return _capabilities;
        };
        this.addCapability = function(cp){
            if(!cp.hasOwnProperty('id') || !cp.hasOwnProperty('version')){
                return;
            }
            _capabilities[cp.vid]=cp;
        }
        var _jsonclone = function (obj) {
            try {
                return JSON.parse(JSON.stringify(obj))
            } catch (err) {
                console.log(err)
                return {}
            }
        }
    }

    var validateAutomationNext = function (id) {
        //Automation 뒤에는 on device(event) 만 올 수 있다 (input 1, 해당 input port 에 연결된 wires 도 하나)
        var backLinks = RED.nodes.filterLinks({"source": {"id": id}});
        if (backLinks.length != 1) return false;
        if (backLinks[0].target["type"] !== "event-device") return false;
        return true;
    }

    var profiles = new Profiles();
</script>
<!-- Node Common Script End-->

<!-- Node Script -->
<script type="text/javascript">
    // var loadingImage = $(`<img id="device-loading-img" src="/red/images/spin.svg" style="display:none;"></img>`)

    const ST_NODES_CATEGORY = "Samsung AutomationStudio"
    const ST_EVENT_DEVICE = "event-device";
    const ST_STATUS_DEVICE = "status-device";
    const ST_COMMAND_DEVICE = "command-device";
    const ST_DEVICE_PROFILE = 'device-profile';
    const ST_MY_DEVICE = 'installed-device';
    const ST_AUTOMATION = 'automation';
    const ST_DEVICE_NODES=[ST_EVENT_DEVICE,ST_STATUS_DEVICE,ST_COMMAND_DEVICE]
    // const ST_NODE_VERSION = 200330
    var stDevice = {};

    function STRefCheck(){
        var map = {}
        var workspaceId = RED.workspaces.active()
        RED.nodes.filterNodes({z: workspaceId}).forEach(function(node){
            if(node.type==ST_DEVICE_PROFILE || node.type == ST_MY_DEVICE){
                if(node.id != node.profileId){
                    //node는 순서대로 생성되기 때문에, 그 후에 profileId가 같은 node는 복사된 node.
                    if(map.hasOwnProperty(node.profileId)){
                        node.profileId=node.id
                    }else{
                        map[node.profileId]=node
                    }
                }
            }
        })

        RED.nodes.filterNodes({z: workspaceId}).forEach(function(node){
            if(ST_DEVICE_NODES.includes(node.type) && map.hasOwnProperty(node.deviceNodeId)){
                node.deviceNodeId=map[node.deviceNodeId].id
                RED.editor.validateNode(node)
            }
        })

        for(var profId in map){
            map[profId].profileId = map[profId].id
        }
        RED.view.redraw()
    }

    RED.nodes.registerType('device-profile', {
        category: ST_NODES_CATEGORY,
        paletteLabel: "Device Profile",
        color: "rgb(168,168,168)",
        defaults: {
            name: {value: "", required: true},
            capabilityId: {value: "", required: true},
            profileId: {value:""}
        },
        inputs: 0,
        outputs: 0,
        icon: "deviceprofile.png",
        label: function () {
            if (this.name) {
                return this.name + ":" + this.capabilityId;
            } else {
                return "Device Profile";
            }
        },
        oneditprepare: function () {
            var NODE = this
            $("#node-input-capabilityId").empty();
            $("#node-input-capabilityId").append($("<option></option>").val("").text(""));
            Object.values(profiles.getAllCapabilities())
                .filter(function(cp){
                    return !!cp._spec === false
                })
                .forEach(function (cp) {
                    $("<option></option>").val(cp.vid).text((cp.version===1?cp.id:cp.vid)).appendTo(("#node-input-capabilityId"))
                })
            $("#node-input-capabilityId").val(NODE.capabilityId);

            //profileId: DeviceNode 참조 backup ID
            if(NODE.profileId==''){
                NODE.profileId=NODE.id
            }else if(NODE.profileId!=NODE.id){
                 var hasBrokenRef = RED.nodes.filterNodes({z: NODE.z, type: NODE.type}).some(function(node){
                     if(node.id == NODE.id){
                         return true
                     }
                     if(node.id == NODE.profileId){
                         NODE.profileId=NODE.id
                         return false;
                     }
                 })
                if(hasBrokenRef){
                    STRefCheck()
                }
            }
        }
    });

    RED.nodes.registerType('installed-device', {
        category: ST_NODES_CATEGORY,
        paletteLabel: "My Device",
        color: "rgb(231,147,173)",
        defaults: {
            name: {value: '', required: true},
            label: {value: ''},
            device: {value:''},
            profileId: {value:''}
        },
        credentials: {
            stAccessToken: {type: 'text', required: true}
        },
        inputs: 0,
        outputs: 0,
        icon: "mydevice.png",
        label: function () {
            if (this.label) {
                return "My Device:" + this.label
            } else {
                return "My Device"
            }
        },
        oneditprepare: function () {
            var NODE = this;

            $("#my-device-list-container")
                .css('min-height', '400px')
                .css('min-width', '150px')
                .editableList({
                    addButton: "GET SmartThings Device List",
                    addItem: function (row, index, data) {
                        var device = data || {}

                        row.data('device', device)
                        $('<div class="device-item">').text(device.label).css('font-weight', 'bold').appendTo(row)

                        var cpSpans=[]
                        if (Array.isArray(device.capabilities)) {
                            device.capabilities.sort((c1,c2)=>{
                                return c1.id.localeCompare(c2.id)
                            }).forEach((cp)=>{
                                cpSpans.push(`<span title="${cp.vid}" vid="${cp.vid}" class="device-item-capability" spec="${profiles.hasCapability(cp.vid)||cp.spec}">${cp.id}</span>`)
                            })
                        }
                        $('<div>').html(cpSpans.join(", ")).appendTo(row)

                        var selectButton = $('<a/>', {href: "#", class: "red-ui-editableList-item-remove editor-button editor-button-small"}).appendTo(row)
                        selectButton.text('select')
                        selectButton.on('click', function () {
                            $('#my-device-list-container .history-stack-selected').removeClass('history-stack-selected')
                            var device = row.data('device')
                            $('#node-input-name').val(device.name)
                            $('#node-input-label').val(device.label)
                            NODE.device = device
                        })
                    },
                    resizeItem: function (container) {
                    },
                    removeItem: function (opt) {
                    },
                    sortItems: function (rules) {
                    },
                    sortable: true,
                    removable: false
                });

            var getItemsFail = function (err) {
                $('#node-input-stAccessToken').addClass('input-error')
                var failMsg = document.createElement('span');
                failMsg.setAttribute('id', 'getDeviceListErrMsg');
                failMsg.style.color = 'red';
                failMsg.style.paddingLeft = '10px';
                failMsg.style.fontsize = '12px';
                failMsg.style.fontWeight = 'bold';
                failMsg.innerText = err.status + ', ' + err.statusText;

                document.querySelector("#my-device-list-div > div > a").insertAdjacentElement('afterend', failMsg);
                var duration = 3000;
                $('#getDeviceListErrMsg').fadeOut(duration, function () {
                    $(this).remove();
                })
            }

            var addItems = function (list) {
                if (list && Array.isArray(list)) {
                    list.sort(function (a, b) {
                        return (a.label > b.label) ? 1 : (a.label == b.label) ? 0 : -1
                    })
                    $('#my-device-list-container').empty()
                    list.forEach(function (device) {
                        $('#my-device-list-container').editableList('addItem', device)
                    })
                }
            }
            var getItemsSuccess = function (list) {
                $('#node-input-stAccessToken').removeClass('input-error')
                NODE.deviceList = list
                addItems(list)
            }
            $('#my-device-list-div > div > a.editor-button,a.red-ui-button').off('click');
            $('#my-device-list-div > div > a.editor-button,a.red-ui-button').on('click', function (evt) {
                evt.preventDefault();
                var token = $('#node-input-stAccessToken').val();
                SmartThingsApi.getDeviceList(token, getItemsSuccess, getItemsFail);
            })
            if (NODE.deviceList && NODE.deviceList.length > 0) {
                addItems(NODE.deviceList)
            } else if (NODE.credentials && NODE.credentials.stAccessToken) {
                SmartThingsApi.getDeviceList(NODE.credentials.stAccessToken, getItemsSuccess, getItemsFail);
            }

            if (!NODE.credentials || !NODE.credentials.stAccessToken) {
                NODE.device = {}
                $('#node-input-name').val('')
                $('#node-input-label').val('')
                $('#my-device-list-container').empty()
            }

            //profileId: DeviceNode 참조 backup ID
            if(NODE.profileId==''){
                NODE.profileId=NODE.id
            }else if(NODE.profileId!=NODE.id){
                var hasBrokenRef = RED.nodes.filterNodes({z: NODE.z, type: NODE.type}).some(function(node){
                    if(node.id == NODE.id){
                        return true
                    }
                    if(node.id == NODE.profileId){
                        NODE.profileId=NODE.id
                        return false;
                    }
                })
                if(hasBrokenRef){
                    STRefCheck()
                }
            }
        },
        oneditsave: function () {
            var NODE = this
            if(NODE.device && NODE.device.capabilities){
                NODE.device.capabilities.forEach(cp=>{
                    var capa = profiles.getCapability(cp.vid)
                    if(capa && capa._spec){
                        Object.assign(cp,capa)
                    }
                })
            }
            //device test
        }
    });

    RED.nodes.registerType('automation', {
        category: ST_NODES_CATEGORY,
        color: "rgb(80, 196, 253)",
        defaults: {
            name: {value: "", required: true},
            method: {value: 'post'},
            url: {
                value: "",
                required: true
            },
            urlDate: {value: ""},
            // isUniqueUrl: {value: false},
            eqtype: {
                value: "", validate: function (v) {
                    return validateAutomationNext(this.id);
                }
            },
            publickey: {value: "---PUBLIC KEY---", required: true}
        },
        inputs: 0,
        outputs: 1,
        icon: "smartapp.png",
        label: function () {
            if (this.url) {
                if (this.method) {
                    return "[" + this.method + "]" + this.url;
                } else {
                    return this.url;
                }
            } else {
                return "Automation";
            }
        },
        labelStyle: function () {
            return this.url ? "node_label_italic" : "";
        },
        paletteLabel: function () {
            return "Automation";
        },
        oneditprepare: function () {
            var NODE = this;
            var $inputUrl = $('#node-input-url')

            RED.popover.create({
                target: $('#export-clipboard'),
                content: 'copied',
                trigger: 'click',
                autoClose: 2000,
                direction: 'right',
                delay: {show: 750, hide: 2000}
            });
            var copyurl = window.location.origin + $inputUrl.val()
            if (copyurl == undefined || copyurl == "") {
                $("#node-input-copyurl").val(window.location.origin);
            } else {
                $("#node-input-copyurl").val(window.location.origin + $inputUrl.val());
            }

            var validateUrl = function(){
                var url = $inputUrl.val()||""
                url=url.replace(/[^a-zA-Z0-9\-\_\/]/gi,'')
                url=url.replace(/[\/]{2,}/gi,'/')
                if(url.charAt(0)!='/'){
                    url='/'+url
                }
                $inputUrl.val(url)
                $("#node-input-copyurl").val(window.location.origin + $inputUrl.val());
            }
            $inputUrl.on("keyup", validateUrl);
            $inputUrl.on("focusin", validateUrl);

            //if safari, hide clipboard button
            if (!document.queryCommandSupported("copy")) {
                $("#node-input-copyurl").parent().closest('div').css('right', '0px');
                $("#export-clipboard").hide();
            } else {
                $("#node-input-copyurl").parent().closest('div').css('right', '40px');
                $("#export-clipboard").show();
                $("#export-clipboard").on("click", function () {
                    RED.clipboard.copyText($("#node-input-copyurl").val());
                });
            }
        },
        oneditsave: function () {
            var NODE = this;
            NODE.method = 'post'
            NODE.name = $("#node-input-name").val().trim();
            if (NODE.url != $("#node-input-url").val().trim()) {
                NODE.urlDate = new Date().getTime()
                NODE.url = $("#node-input-url").val().trim()
            }
        }
    });

    var operator = {
        string: [
            {v: "eq", t: "=="},
            {v: "neq", t: "!="}
        ],
        array: [
            {v: "in", t: "contains"},
            {v: "nin", t: "not contains"}
        ],
        integer: [
            {v: "eq", t: "=="},
            {v: "neq", t: "!="},
            {v: "lt", t: "<"},
            {v: "lte", t: "<="},
            {v: "gt", t: ">"},
            {v: "gte", t: ">="}
        ],
        number: [
            {v: "eq", t: "=="},
            {v: "neq", t: "!="},
            {v: "lt", t: "<"},
            {v: "lte", t: "<="},
            {v: "gt", t: ">"},
            {v: "gte", t: ">="}
        ],
        object: [
            {v: "o_eq", t: "all values equal"},
            {v: "o_neq", t: "all values not equal"}
        ],
        boolean: [
            {v: "eq", t: "=="},
            {v: "neq", t: "!="}
        ],
        Iso8601Date: [
            {v: "eq", t: "=="},
            {v: "neq", t: "!="},
            {v: "lt", t: "<"},
            {v: "lte", t: "<="},
            {v: "gt", t: ">"},
            {v: "gte", t: ">="}
        ],
        json: [
            {v: "o_eq", t: "all values equal "},
            {v: "o_neq", t: "all values not equal"}
            // {v: "o_include", t: "include"}
        ]
    }

    function DeviceNodeEventHandler(formObj, node) {
        var THING = this;
        THING.node = node;
        THING.type = node.type;
        THING.form = formObj;
        THING.target = (node.type == ST_COMMAND_DEVICE) ? "commands" : "attributes"
        THING.device={}
    // }
    //
    // DeviceNodeEventHandler.prototype = {
        THING.initDeviceNodeSelect = function (initDeviceNodeId) {
            var deviceNodeIdSelect = this.form.deviceNodeId
            deviceNodeIdSelect.html('')
            var deviceNodeList = []
            deviceNodeList = RED.nodes.filterNodes({z: this.node.z, type: ST_DEVICE_PROFILE})
            deviceNodeList.map(function(node){
                var id = node.capabilityId.split('_v')[0]
                var version = node.capabilityId.split('_v')[1]||1
                var vid = id+'_v'+version
                node.device={capabilities:[{id:id,version:version,vid:vid}]}
            })
            // if (this.type != ST_EVENT_DEVICE) {
            deviceNodeList = deviceNodeList.concat(RED.nodes.filterNodes({z: this.node.z, type: ST_MY_DEVICE}))
            // }

            deviceNodeList.forEach(node=>{
                if (node.name && node.device && node.device.capabilities) {
                    node.device.capabilities.forEach(cp=>{
                        if(typeof cp === 'string'){
                            cp = {id:cp,version:1,vid:cp+'_v1'}
                        }
                        if(profiles.hasCapability(cp.vid)===false && cp._spec){
                            profiles.addCapability(cp)
                        }
                    })
                }
            })
            //custom capability check
            // deviceNodeList.forEach(function(node){
            //     if (node.name && node.device && node.device.capabilities) {
            //         var prs = []
            //         node.device.capabilities.filter(cp=>{
            //             return profiles.hasCapability(cp.vid)===false && node.credentials && node.credentials.stAccessToken
            //         }).forEach(cp=>{
            //             node.device.isLoading=true
            //             var pr = SmartThingsApi.getCapability(node.credentials.stAccessToken,cp.id,cp.version).promise()
            //             prs.push(pr)
            //         })
            //         if(prs.length > 0 && initDeviceNodeId === node.id){
            //             loadingImage.show()
            //         }
            //         Promise.allSettled(prs).finally(function(cps){
            //             node.device.isLoading=false
            //             if(deviceNodeIdSelect.val() === node.id){
            //                 // loadingImage.hide()
            //                 THING.initCapabilitySelect(THING.node.capabilityId)
            //                 THING.initAttributeSelect(THING.node.attributeId)
            //                 THING.initAttributeContainer(THING.node.rules)
            //             }
            //         })
            //     }
            // })

            var target = this.target
            var enableList = deviceNodeList.filter(node=>{
                return node.name && node.device && node.device.capabilities
            }).filter(node=>{
                node.hasTarget = node.device.capabilities.some(function (_cp) {
                    var cp = profiles.getCapability(_cp.vid)
                    return cp && cp.hasOwnProperty(target) && Object.keys(cp[target]).length>0
                })

                if(THING.type === ST_EVENT_DEVICE){
                    node.isValidType =  node.type === ST_DEVICE_PROFILE
                }else{
                    node.isValidType =  true
                }
                if(node.isValidType && node.hasTarget){
                    if (node.type == ST_DEVICE_PROFILE) {
                        deviceNodeIdSelect.prepend($("<option></option>").val(node.id).data('device', node.device).text(node.name + ":" + node.capabilityId))
                    } else if (node.type == ST_MY_DEVICE) {
                        deviceNodeIdSelect.append($("<option></option>").val(node.id).data('device', node.device).text("(My)" + node.label))
                    }
                }
                return !(node.isValidType && node.hasTarget)
            }).forEach(function (node) {
                var msgarr=[]
                if(node.isValidType===false){
                    msgarr.push('Type : '+node.type)
                }
                if(node.hasTarget===false){
                    msgarr.push('No '+target)
                }
                var disableMsg = msgarr.join(' / ')
                if (node.type == ST_DEVICE_PROFILE) {
                    deviceNodeIdSelect.append(`<optgroup label="${node.name}:${node.capabilityId}" title="${disableMsg}" style="color:#ccc;"> `)
                } else if (node.type == ST_MY_DEVICE) {
                    deviceNodeIdSelect.append(`<optgroup label="(My)${node.label}" title="${disableMsg}" style="color:#ccc;"> `)
                }
            })
            if (initDeviceNodeId){
                if(deviceNodeIdSelect.find('option[value="'+initDeviceNodeId+'"]').length==0){
                    STRefCheck()
                    deviceNodeIdSelect.val(this.node.deviceNodeId)
                    // console.log('initDeviceNodeId : '+initDeviceNodeId+','+this.node.deviceNodeId)
                } else if(deviceNodeIdSelect.find('option[value="'+initDeviceNodeId+'"]').length>0) {
                    deviceNodeIdSelect.val(initDeviceNodeId)
                }
            }
        }
        //deviceid 선택시 해당 section 정보를 셋팅한다.
        THING.initCapabilitySelect = function (initCapabilityId) {
            var capabilityIdSelect = this.form.capabilityId
            capabilityIdSelect.html('')
            var device = this.form.deviceNodeId.find('option:selected').data('device')
            if(device && device.isLoading){
                capabilityIdSelect.attr('disabled', true)
                return
            }
            if (device && device.capabilities) {
                var target = this.node.target;
                device.capabilities.sort(function(c1,c2){
                    return c1.id.localeCompare(c2.id)
                }).filter(function (_cp) {
                    var cp = profiles.getCapability(_cp.vid)
                    if (cp && cp.hasOwnProperty(target) && Object.keys(cp[target]).length>0) {
                        capabilityIdSelect.append($("<option></option>").val(cp.vid).text(cp.id))
                    }
                    return !(cp && cp.hasOwnProperty(target) && Object.keys(cp[target]).length>0)
                }).forEach(function(_cp){
                    var cp = profiles.getCapability(_cp.vid)

                    var disableMsg=''
                    if(!cp){
                        disableMsg = 'undefined capability, '+_cp.vid
                    }else{
                        disableMsg = 'no '+target
                    }
                    capabilityIdSelect.append(`<optgroup vid="${_cp.vid}" label="${_cp.id}" title="${disableMsg}" style="color:#ccc;"> `)
                })

                capabilityIdSelect.removeClass("input-error")
                if (capabilityIdSelect.find('option').length <= 1) {
                    capabilityIdSelect.attr('disabled', true)
                } else {
                    capabilityIdSelect.attr('disabled', false)
                }

                capabilityIdSelect.find('option:first').attr("selected", true)
            } else {
                this.form.deviceNodeId.addClass("input-error")
            }

            if (initCapabilityId && capabilityIdSelect.find('option[value="'+initCapabilityId+'"]').length>0) {
                capabilityIdSelect.val(initCapabilityId)
            }
        }
        //capability attr 셀렉트박스구성
        THING.initAttributeSelect = function (initAttributeId) {
            var attributeIdSelect = this.form.attributeId
            attributeIdSelect.html('');

            var selectedCapabilityId = this.form.capabilityId.find("option:selected").val();

            //capability의 attributes 및 commands 정보 조회
            var capability = profiles.getCapability(selectedCapabilityId);
            if (capability && capability.hasOwnProperty(this.target) ) {
                Object.keys(capability[this.target]).forEach(function (attributeId) {
                    attributeIdSelect.append($("<option></option>").val(attributeId).text(attributeId));
                })
            }

            if (attributeIdSelect.find('option').length <= 1) {
                attributeIdSelect.attr('disabled', true)
                attributeIdSelect.attr('readonly', true)
            } else {
                attributeIdSelect.attr('readonly', false)
                attributeIdSelect.attr('disabled', false)
            }
            if (initAttributeId && attributeIdSelect.find('option[value="'+initAttributeId+'"]').length>0) {
                attributeIdSelect.val(initAttributeId)
            }
        }
        THING.initContainer = function(){
            $("#cmd-list-container").css('min-height', '150px').css('min-width', '150px').editableList({
                addButton: false,
                addItem: function (container, idx, data) {
                    var capabilityId = $("#node-input-capabilityId option:selected").val()
                    var commandId = $("#node-input-attributeId option:selected").val()
                    var arguments = profiles.getCommandArguments(capabilityId, commandId)

                    var row = $('<div/>', {style: "margin-left:10px;height: auto;"}).appendTo(container);
                    $('<span>', {class: "capaId"}).appendTo(row).text(capabilityId)
                    $('<span style="font-size: 20px; font-weight: bold;">.</span>').appendTo(row)
                    $('<span>', {class: "attrId"}).appendTo(row).text(commandId)
                    var argNames = arguments.map(function (arg) {
                        return arg.name
                    }).join(', ')
                    $('<span>').appendTo(row).text(' ( ' + argNames + ' )')

                    if (arguments.length > 0) {
                        arguments.forEach(function (arg) {
                            var row2 = $('<div/>', {style: "height:auto;margin:15px 5px 5px auto;width:100%;display:flex;align-items:center;justify-content:flex-end;"}).appendTo(row)
                            createValueField2(arg.schema,row2,{valueName:arg.name,rowName:arg.name,width:'50%'})
                        })
                    }

                    if (data && data.args) {
                        data.args.forEach(function (arg) {
                            var valueField
                            if(arg.hasOwnProperty('propId')){
                                valueField = container.find('.argValue[argName='+arg.name+'][propId='+arg.propId+']')
                            }else{
                                valueField = container.find('.argValue[argName=' + arg.name + ']')
                            }
                            if (valueField.hasClass('red-ui-typedInput')) {
                                valueField.typedInput('value', arg.value)
                            } else {
                                valueField.val(arg.value)
                            }
                        })
                    }

                    if ($("#cmd-list-container").editableList('items').length > 1) {
                        $("#cmd-list-container").find(".outputSpan").remove();
                    }

                },
                resizeItem: function (container) {
                },
                removeItem: function (opt) {
                },
                sortItems: function (rules) {
                },
                sortable: false,
                removable: false
            });

            var emptymsg =null
            if(THING.node.type===ST_STATUS_DEVICE){
                emptymsg = "There is no filter, whole device status response will be sent"
            }

            $("#attr-list-container").css('min-height', '150px').css('min-width', '150px').editableList({
                addButton: "Add Filter",
                emptyMessage: emptymsg,
                addItem: function (itemRow, idx, data) {
                    if(data.type === 'empty'){
                        $(itemRow).parent().html('').append(data.msg)
                        // $(container).append(data.msg)
                        return;
                    }
                    var capabilityId = $("#node-input-capabilityId option:selected").val()
                    var attributeId = $("#node-input-attributeId option:selected").val()
                    var attribute = profiles.getAttributeSchema(capabilityId, attributeId)

                    var row = $('<div/>', {style: "height: auto;margin:5px 0 5px 0;"}).appendTo(itemRow);

                    var attributeIdField = $('<input/>', {
                        class: "attrId ruleField",
                        capaId: capabilityId,
                        style: "width:auto; margin-right:5px;max-width:30%",
                        type: "text",
                        readonly: "true"
                    }).appendTo(row).val(attributeId)
                    var valueProperty = attribute.properties.value
                    var unitProperty = attribute.properties.unit

                    itemRow.data('data',{capaId:capabilityId,attrId:attributeId,valueType:valueProperty.type})
                    var ruleSpan = $('<span></span>').appendTo(row)
                    createRuleFields(valueProperty,unitProperty,ruleSpan,data)

                    if(itemRow.find('.ruleField').length>3){
                        itemRow.find('.attrId').css('width','20%')
                    }
                },
                resizeItem: function (container) {
                },
                removeItem: function (opt) {
                },
                sortItems: function (rules) {
                },
                sortable: true,
                removable: true
            });
            function createRuleFields(valueProperty,unitProperty,row,data){

                if(valueProperty.title=='Iso8601Date'){
                    valueProperty.type='Iso8601Date'
                }else if(valueProperty.title=='JsonObject'){
                    valueProperty.type='json'
                }else if(valueProperty.type==='object' && (!valueProperty.hasOwnProperty('properties') && valueProperty.title != 'COLOR_MAP' ) ){
                    valueProperty.type='json'
                }
                //oepratorField
                var operatorField = createOperatorField(valueProperty.type).appendTo(row)

                //attribute properties.value
                //typedInput 사용하려면 row에 html 추가된 상태여야함
                var valueField = createValueField2(valueProperty,row)

                //'unit' always has string enum
                var unitField =null
                if (unitProperty && unitProperty.enum) {
                    unitField = createUnitField(unitProperty).appendTo(row);
                }

                if (data) {
                    data.operator && operatorField.val(data.operator)
                    if(data.value){
                        if(data.valueType === 'object' && typeof data.value === 'object'){
                            Object.keys(data.value).forEach(propId=>{
                                var valueField = row.find(`.valueField[propId=${propId}]`)
                                if(valueField.prop('tagName')=='INPUT'){
                                    valueField.typedInput('value',data.value[propId])
                                }else{
                                    valueField.val(data.value[propId])

                                }
                            })
                        }else{
                            if (valueField[0].prop('tagName') == 'INPUT') {
                                valueField[0].typedInput('value', data.value)
                            } else {
                                valueField[0].val(data.value)
                            }
                        }
                    }
                    // data.value && valueField.find('.attrValue').val(data.value)
                    data.unit && unitField && unitField.val(data.unit)
                }
            }
            function createOperatorField(valueType){
                var operatorField = $('<select/>', {class: "attrOperator ruleField", style: "width:auto; margin-right: 5px; text-align: center;max-width:25%"})
                if (operator[valueType]) {
                    operator[valueType].forEach(function (op) {
                        operatorField.append($("<option></option>").val(op.v).text(op.t))
                    })
                }
                return operatorField
            }
            function createValueField(valueProp,row){
                var valueField=null
                if (valueProp.type == 'array') {
                    if(valueProp.items.enum){
                        valueField = $("<select/>", {style: "width:40%;margin-right:5px;"}).appendTo(row)
                        valueProp.items.enum.forEach(function (value) {
                            valueField.append($("<option></option>").val(value).text(value))
                        })
                    }else if(valueProp.items.type){
                        var holder = valueProp.title
                        if (valueProp.hasOwnProperty('minimum') || valueProp.hasOwnProperty('maximum')||valueProp.hasOwnProperty('min')||valueProp.hasOwnProperty('max')) {
                            holder += '('
                            holder += valueProp.hasOwnProperty('minimum') ? valueProp.minimum : (valueProp.hasOwnProperty('min')?valueProp.min:' ')
                            holder += '~'
                            holder += valueProp.hasOwnProperty('maximum') ? valueProp.maximum : (valueProp.hasOwnProperty('max')?valueProp.max:' ')
                            holder += ')'
                        }

                        valueField = $("<input/>", {style: "margin-right:5px;width:40%;",placeholder:holder}).appendTo(row)
                        var valueType = valueProp.items.type
                        if (valueType == 'integer' || valueType == 'number') {
                            valueField.typedInput({default: "num", types: ["num"]})
                        } else {
                            valueField.typedInput({default: "str", types: ["str"]})
                        }

                    }

                } else if (valueProp.enum) {
                    valueField = $("<select/>", {style: "width:40%;margin-right:5px;"}).appendTo(row)

                    valueProp.enum.forEach(function (value) {
                        valueField.append($("<option></option>").val(value).text(value))
                    })
                }else if (valueProp.type == 'object') {
                    var holder = valueProp.title || valueProp.type || ''
                    valueField = $("<input/>", {style: "margin-right:5px;width:40%;", placeholder: holder}).appendTo(row)
                    valueField.typedInput({default: "str", types: ["str"]})
                }else if (valueProp.type == 'boolean') {
                    valueField = $("<select/>", {style: "width:40%;margin-right:5px;"}).appendTo(row)
                    valueField.append($("<option></option>").val('true').text('true'))
                    valueField.append($("<option></option>").val('false').text('false'))
                    if(valueProp.default){
                        valueField.val(''+valueProp.default)
                    }
                } else {
                    var holder = valueProp.title || $("#node-input-attributeId option:selected").val()
                    if (valueProp.hasOwnProperty('minimum') || valueProp.hasOwnProperty('maximum')||valueProp.hasOwnProperty('min')||valueProp.hasOwnProperty('max')) {
                        holder += '('
                        holder += valueProp.hasOwnProperty('minimum') ? valueProp.minimum : (valueProp.hasOwnProperty('min')?valueProp.min:' ')
                        holder += '~'
                        holder += valueProp.hasOwnProperty('maximum') ? valueProp.maximum : (valueProp.hasOwnProperty('max')?valueProp.max:' ')
                        holder += ')'
                    }

                    valueField = $("<input/>", {style: "margin-right:5px;", placeholder: holder}).appendTo(row)

                    var valueType = valueProp.type
                    if (valueType == 'integer' || valueType == 'number') {
                        valueField.typedInput({default: "num", types: ["num"]})
                    } else {
                        valueField.typedInput({default: "str", types: ["str"]})
                    }
                    if(valueType == 'Iso8601Date'){
                        valueField.typedInput('value',new Date().toISOString().substr(0,19)+'Z')
                    }
                    valueField.typedInput('width','40%')
                }
                valueField.attr('valueType', valueProp.type)
                valueField.addClass('attrValue ruleField')
                return valueField
            }

            function createValueField2(valueProp,row,option){
                option=option || {}
                if(option.rowName){
                    row.text(option.rowName + ' : ')
                }
                var valueField=null
                if (valueProp.enum || (valueProp.type == 'array' && valueProp.items && valueProp.items.enum)) {
                    valueField = $("<select/>").appendTo(row)
                    if(option.hasOwnProperty('propId')){
                        valueField.append($("<option></option>").val('').text(''))
                    }
                    var enums = valueProp.enum || valueProp.items.enum
                    enums.forEach(function (value) {
                        valueField.append($("<option></option>").val(value).text(value))
                    })
                }else if (valueProp.type == 'string' ) {
                    var holder = valueProp.type||''
                    if(valueProp.hasOwnProperty('maxLength')){
                        holder += ', maxLength:'+valueProp.maxLength
                    }
                    valueField = $("<input/>",{placeholder:holder})
                        .appendTo(row)
                        .typedInput({default: "str", types: ["str"]})

                }else if(valueProp.type == 'number' || valueProp.type == 'integer'){
                    var holder = valueProp.title||valueProp.type||''
                    if (valueProp.hasOwnProperty('minimum') || valueProp.hasOwnProperty('maximum')||valueProp.hasOwnProperty('min')||valueProp.hasOwnProperty('max')) {
                        holder += '('
                        holder += valueProp.hasOwnProperty('minimum') ? valueProp.minimum : (valueProp.hasOwnProperty('min')?valueProp.min:' ')
                        holder += '~'
                        holder += valueProp.hasOwnProperty('maximum') ? valueProp.maximum : (valueProp.hasOwnProperty('max')?valueProp.max:' ')
                        holder += ')'
                    }
                    valueField = $("<input/>", {placeholder:holder})
                        .appendTo(row)
                        .typedInput({default: "num", types: ["num"]})

                }else if (valueProp.type == 'array') {
                    if(Array.isArray(valueProp.items)){
                        throw new Error('unknown data schema, typeof array.items == array')
                    }else if(typeof valueProp.items === 'object'){
                        return createValueField2(valueProp.items,row)
                    }else{
                        throw new Error('unknown data schema '+valueProp.type)
                    }
                }else if (valueProp.type == 'boolean') {
                    valueField = $("<select/>").appendTo(row)
                    if(option.hasOwnProperty('propId')){
                        valueField.append($("<option></option>").val('').text(''))
                    }
                    valueField.append($("<option></option>").val('true').text('true'))
                    valueField.append($("<option></option>").val('false').text('false'))
                    if(valueProp.default){
                        valueField.val(''+valueProp.default)
                    }
                } else if (valueProp.type == 'vector3') {
                    //TODO : vector type
                    throw new Error('vector data type')
                } else if (valueProp.type == 'json') {
                    valueField = $("<input/>",{placeholder:'Json Object'})
                        .appendTo(row)
                        .typedInput({default: "str", types: ["str"]})

                } else if (valueProp.type == 'Iso8601Date') {
                    var holder = ''
                    valueField = $("<input/>",{placeholder:holder})
                        .appendTo(row)
                        .typedInput({default: "str", types: ["str"]})

                    valueField.typedInput('value',new Date().toISOString().substr(0,19)+'Z')
                    //TODO : pattern valid check
                } else if (valueProp.type == 'object') {
                    if(valueProp.title ==='COLOR_MAP'){
                        valueField = $("<input/>", {
                            argName: "color",
                            argType: "object",
                            propId: 'hex',
                            propType: 'string',
                            class: 'argValue',
                            type: 'color',
                            value: "#3366ff",
                            style: "width:50%;margin-right:5px;"
                        }).appendTo(row)
                        Object.assign(option,{valueName: "color",valueType: "object",propId: 'hex',propType: 'string',})
                    // }else if(valueProp.){//TODO : threeAxis vector
                    //
                    }else if (valueProp.hasOwnProperty('properties')){
                        var fields=[]
                        Object.keys(valueProp.properties).forEach(k=>{
                            var row2 = $('<div style="display:flex;align-items:center;justify-content:flex-end;"></div>').appendTo(row)
                            Object.assign(option,{valueType:valueProp.type,propId:k,propType:valueProp.properties[k].type,rowName:k})
                            fields.concat(createValueField2(valueProp.properties[k],row2,option))
                        })
                        return fields
                    }else {
                        var holder = valueProp.title || valueProp.type || ''
                        valueField = $("<input/>", {placeholder: holder}).appendTo(row)
                        valueField.typedInput({default: "str", types: ["str"]})
                        // throw new Error('unknown data schema, '+valueProp.type+' unkwon')
                        console.error('unknown data schema, '+valueProp.type+' unknown')
                    }

                } else {
                    throw new Error('unknown data schema')
                }
                valueField.addClass('argValue valueField')
                valueField.css('margin-right','5px')
                if(option.hasOwnProperty('propId')){
                    valueField.attr('propId',option.propId)
                }
                try{
                    valueField.typedInput('width',option.width||'40%')
                }catch(e){
                    valueField.css('width',option.width||'40%')
                }
                valueField.data('data',Object.assign({valueType:valueProp.type},option))
                if(Array.isArray(valueField)){
                    return valueField
                }else{
                    return [valueField]
                }
            }

            function createUnitField(unitProp){
                var unitField = null
                if (unitProp && unitProp.hasOwnProperty('enum')) {
                    unitField = $("<select/>", {class: 'attrUnit ruleField', style: "width:auto;margin-right:5px;"})
                    unitProp.enum.forEach(function (value) {
                        unitField.append($('<option>').val(value).text(value))
                    })
                    if (unitProp.default) {
                        unitField.val(unitProp.default)
                    }
                }
                return unitField
            }
            if(THING.node.type===ST_STATUS_DEVICE && $("#attr-list-container").length>0){
                var msg1 = $('<span style="position:absolute;right:2em;""><i class="fa fa-info-circle" aria-hidden="true"></i>  No Filter : msg.payload = whole device status response</span>')
                $('#dialog-form > div.form-row.sensor-container-row > div > a').after(msg1)
            }
        }
        //type값에 따른 페이지 초기화 함수
        THING.initAttributeContainer = function (rules) {
            this.form.container.editableList('empty')

            if (rules && rules.length) {
                for (var i = 0; i < this.node.rules.length; i++) {
                    var data = this.node.rules[i];
                    if (data.isInit) break;
                    if(data.capaId == this.form.capabilityId.val() && data.attrId == this.form.attributeId.val()){
                        this.form.container.editableList('addItem', data);
                    }
                }
            }

            if (this.form.attributeId.val() && this.form.container.editableList('items').length == 0) {
                // if(THING.node.type!=ST_STATUS_DEVICE){//test_code
                    this.form.container.editableList('addItem')
                // }
                // this.form.container.editableList('addItem',{type:'empty',msg:'no condition, send whole device status response'})
            }
        }

        THING.initContainer()

        THING.initDeviceNodeSelect(node.deviceNodeId)
        THING.initCapabilitySelect(node.capabilityId)
        THING.initAttributeSelect(node.attributeId)
        THING.initAttributeContainer(node.rules)

        THING.form.deviceNodeId.on("mouseover", function () {
            THING.form.deviceNodeId.off("change")
            THING.form.deviceNodeId.on("change", function (e) {
                // if(RED.nodes.node(e.target.value).device.isLoading){
                //     loadingImage.show()
                // }else{
                //     loadingImage.hide()
                // }
                THING.initCapabilitySelect()
                THING.initAttributeSelect()
                THING.initAttributeContainer()
            })
        })

        THING.form.capabilityId.on("mouseover", function () {
            THING.form.capabilityId.off("change")
            THING.form.capabilityId.on("change", function () {
                THING.initAttributeSelect()
                THING.initAttributeContainer()
            })
        })

        THING.form.attributeId.on("mouseover", function () {
            THING.form.attributeId.off("change")
            THING.form.attributeId.on("change", function () {
                THING.initAttributeContainer()
            })
        })
    };

    //convert RGB value to HSL value
    function rgbToHsl(hex) {
        if (/^#[0-9a-f]{6}$/g.test(hex) == false) {
            return {hue: 0, saturation: 0, lightness: 0}
        }
        var r = parseInt(hex.substring(1, 3), 16) / 255
        var g = parseInt(hex.substring(3, 5), 16) / 255
        var b = parseInt(hex.substring(5, 7), 16) / 255
        var max = Math.max(r, g, b)
        var min = Math.min(r, g, b)
        var hue
        if (max == min) {
            hue = 0
        } else if (r == max) {
            hue = 0 + (g - b) / (max - min)
        } else if (g == max) {
            hue = 2 + (b - r) / (max - min)
        } else {
            hue = 4 + (r - g) / (max - min)
        }
        hue *= 60

        var lightness = (max + min) / 2

        var saturation
        if (lightness == 0 || lightness == 1) {
            saturation = 0
        } else {
            a1 = 2 * (max - lightness)
            a2 = 1 - Math.abs(2 * lightness - 1)
            saturation = a1 / a2
        }

        hue = Math.round(hue / 360 * 100)
        saturation = Math.round(saturation * 100)
        lightness = Math.round(lightness * 100)
        return {hex: hex, hue: hue, saturation: saturation, lightness: lightness}
    }

    RED.nodes.registerType('event-device',{
        paletteLabel : "Event",
        color : "rgb(113,179,145)",
        icon : "st-event.png",
        category: ST_NODES_CATEGORY,
        defaults : {//노드 의 편집 가능한 속성과 deploy시 json 형태로 저장될 데이터구조명시
            name: {required: true},
            deviceNodeId: {
                value: "", required: true,
                validate: function (val) {
                    var isValidDevice = false;
                    RED.nodes.eachNode(function (node) {
                        if (node.id == val) {
                            isValidDevice = true
                        }
                    })
                    return !!val && isValidDevice
                }
            },
            deviceId: {value: ""},
            componentID: {value: ""},
            capabilityId: {value: "", required: true},
            attributeId: {value: "", required: true},
            rules: {value: [{isInit: true}]},
            outputs: {value: 1}
        },
        inputs: 1,
        outputs: 1,
        label: function () {
            return this.name || this.type;
        },
        labelStyle: function () {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function () {
            var NODE = this;

            var target = (NODE.type == ST_COMMAND_DEVICE) ? "commands" : "attributes"
            NODE.target = target

            var formObj = {
                deviceNodeId: $("#node-input-deviceNodeId"),
                capabilityId: $("#node-input-capabilityId"),
                attributeId: $("#node-input-attributeId"),
                container: ((NODE.type == ST_COMMAND_DEVICE) ? $("#cmd-list-container") : $("#attr-list-container")),
            }

            var eventHandler = new DeviceNodeEventHandler(formObj, NODE)
        },
        /*편집 대화 상자 완료처리시 호출*/
        oneditsave: function () {
            var NODE = this;
            NODE.deviceId = $('#node-input-deviceNodeId').find('option:selected').data('device').deviceId || ''

            NODE.rules = []

            saveCommandRules(NODE);
            saveAttributesRules(NODE);

            this.outputs = NODE.rules.length || 1

            if($('#node-input-name').val()=='' && $('#node-input-attributeId').val()){
                $('#node-input-name').attr('placeholder',$('#node-input-deviceNodeId').text()+' - '+$('#node-input-capabilityId').val())
            }
        },
        //editor height 변화에 따라 attr-container의 height를 조정한다.
        oneditresize: function (size) {
            var rows;
            var resizeContainer;
            var editorRow;

            if (this.type == ST_COMMAND_DEVICE) {
                rows = $("#dialog-form>div:not('[class$=container-row]')");
                editorRow = $("#dialog-form>div.actuator-container-row");
                resizeContainer = $("#cmd-list-container");
            } else {
                //event, sensor
                rows = $("#dialog-form>div:not('[class$=container-row]')");
                editorRow = $("#dialog-form>div.sensor-container-row");
                resizeContainer = $("#attr-list-container");
            }

            var height = size.height;
            for (var i = 0; i < rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }

            height -= (parseInt(editorRow.css("marginTop")) + parseInt(editorRow.css("marginBottom")))
            resizeContainer.editableList('height', height - 100)
        }
    });
    RED.nodes.registerType('status-device',{
        paletteLabel : "Status",
        color : "rgb(119,197,191)",
        icon : "st-status.png",
        category: ST_NODES_CATEGORY,
        defaults : {//노드 의 편집 가능한 속성과 deploy시 json 형태로 저장될 데이터구조명시
            name: {required: true},
            deviceNodeId: {
                value: "", required: true,
                validate: function (val) {
                    var isValidDevice = false;
                    RED.nodes.eachNode(function (node) {
                        if (node.id == val) {
                            isValidDevice = true
                        }
                    })
                    return !!val && isValidDevice
                }
            },
            deviceId: {value: ""},
            componentID: {value: ""},
            capabilityId: {value: "", required: true},
            attributeId: {value: "", required: true},
            rules: {value: [{isInit: true}]},
            outputs: {value: 1}
        },
        inputs: 1,
        outputs: 1,
        label: function () {
            return this.name || this.type;
        },
        labelStyle: function () {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function () {
            var NODE = this;

            var target = (NODE.type == ST_COMMAND_DEVICE) ? "commands" : "attributes"
            NODE.target = target

            var formObj = {
                deviceNodeId: $("#node-input-deviceNodeId"),
                capabilityId: $("#node-input-capabilityId"),
                attributeId: $("#node-input-attributeId"),
                container: ((NODE.type == ST_COMMAND_DEVICE) ? $("#cmd-list-container") : $("#attr-list-container")),
            }

            var eventHandler = new DeviceNodeEventHandler(formObj, NODE)
        },
        /*편집 대화 상자 완료처리시 호출*/
        oneditsave: function () {
            var NODE = this;
            NODE.deviceId = $('#node-input-deviceNodeId').find('option:selected').data('device').deviceId || ''

            NODE.rules = []

            saveCommandRules(NODE);
            saveAttributesRules(NODE);

            this.outputs = NODE.rules.length || 1

            if($('#node-input-name').val()=='' && $('#node-input-attributeId').val()){
                $('#node-input-name').attr('placeholder',$('#node-input-deviceNodeId').text()+' - '+$('#node-input-capabilityId').val())
            }
        },
        //editor height 변화에 따라 attr-container의 height를 조정한다.
        oneditresize: function (size) {
            var rows;
            var resizeContainer;
            var editorRow;

            if (this.type == ST_COMMAND_DEVICE) {
                rows = $("#dialog-form>div:not('[class$=container-row]')");
                editorRow = $("#dialog-form>div.actuator-container-row");
                resizeContainer = $("#cmd-list-container");
            } else {
                //event, sensor
                rows = $("#dialog-form>div:not('[class$=container-row]')");
                editorRow = $("#dialog-form>div.sensor-container-row");
                resizeContainer = $("#attr-list-container");
            }

            var height = size.height;
            for (var i = 0; i < rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }

            height -= (parseInt(editorRow.css("marginTop")) + parseInt(editorRow.css("marginBottom")))
            resizeContainer.editableList('height', height - 100)
        }
    });

    function saveCommandRules(NODE) {
        $("#cmd-list-container").editableList('items').each(function (idx, item) {
            var rule = {};
            rule.capaId = item.find('.capaId').text()
            rule.attrId = item.find(".attrId").text()
            rule.args = [];
            item.find(".argValue").each(function (idx, _arg) {
                var data = $(_arg).data('data')
                var arg = {}

                arg.name = data.valueName
                arg.type = data.valueType
                arg.value = $(_arg).val()
                if (data.hasOwnProperty('propId')) {
                    arg.propId = data.propId
                }
                if (data.hasOwnProperty('propType')) {
                    arg.propType = data.propType
                }
                rule.args.push(arg)

                if (arg.name == 'color') {
                    var hsl = rgbToHsl(arg.value)
                    rule.args.push({name: 'color', type: 'object', propId: 'hue', propType: 'number', value: hsl.hue})
                    rule.args.push({name: 'color', type: 'object', propId: 'saturation', propType: 'number', value: hsl.saturation})
                }
            })
            NODE.rules.push(rule)
        })
    }

    function saveAttributesRules(NODE) {
        $("#attr-list-container").editableList('items').each(function (idx, item) {
            var itemData = item.data('data')
            var valueData = item.find('.attrValue').data('data')
            var rule = {}
            rule.capaId = itemData.capaId
            rule.attrId = itemData.attrId
            rule.operator = item.find(".attrOperator").val()
            rule.valueType = itemData.valueType

            if(rule.valueType != 'object'){
                rule.value = item.find(".valueField").val()

                if (rule.valueType.toLowerCase().indexOf('integer') > -1 || rule.valueType.toLowerCase().indexOf('number') > -1) {
                    try{
                        rule.value = Number(rule.value)
                    }catch(e){}
                }
            }else{
                var valueObj = {}
                item.find(".valueField").each((i,valueField)=> {
                    valueData = $(valueField).data('data')
                    valueObj[valueData.propId] = $(valueField).val()

                    if (valueData.propType.toLowerCase().indexOf('integer') > -1 || valueData.propType.toLowerCase().indexOf('number') > -1) {
                        try {
                            if($(valueField).val().length>0){
                                valueObj[valueData.propId] = Number($(valueField).val())
                            }
                        }catch (e) {}
                    }
                })
                rule.value = valueObj
            }
            rule.unit = item.find(".attrUnit").val()

            NODE.rules.push(rule)
        })
    }

    RED.nodes.registerType('command-device', {
        paletteLabel: "Command",
        color: "rgb(255,198,109)",
        icon: "st-command.png",
        category: ST_NODES_CATEGORY,
        defaults : {//노드 의 편집 가능한 속성과 deploy시 json 형태로 저장될 데이터구조명시
            name: {required: true},
            deviceNodeId: {
                value: "", required: true,
                validate: function (val) {
                    var isValidDevice = false;
                    RED.nodes.eachNode(function (node) {
                        if (node.id == val) {
                            isValidDevice = true
                        }
                    })
                    return !!val && isValidDevice
                }
            },
            deviceId: {value: ""},
            componentID: {value: ""},
            capabilityId: {value: "", required: true},
            attributeId: {value: "", required: true},
            rules: {value: [{isInit: true}]},
            outputs: {value: 1}
        },
        inputs: 1,
        outputs: 1,
        label: function () {
            return this.name || this.type;
        },
        labelStyle: function () {
            return this.name ? "node_label_italic" : "";
        },
        oneditprepare: function () {
            var NODE = this;

            var target = (NODE.type == ST_COMMAND_DEVICE) ? "commands" : "attributes"
            NODE.target = target

            var formObj = {
                deviceNodeId: $("#node-input-deviceNodeId"),
                capabilityId: $("#node-input-capabilityId"),
                attributeId: $("#node-input-attributeId"),
                container: ((NODE.type == ST_COMMAND_DEVICE) ? $("#cmd-list-container") : $("#attr-list-container")),
            }

            var eventHandler = new DeviceNodeEventHandler(formObj, NODE)
        },
        /*편집 대화 상자 완료처리시 호출*/
        oneditsave: function () {
            var NODE = this;
            NODE.deviceId = $('#node-input-deviceNodeId').find('option:selected').data('device').deviceId || ''
            NODE.rules = []
            saveCommandRules(NODE);
            saveAttributesRules(NODE);

            this.outputs = NODE.rules.length || 1

            if($('#node-input-name').val()=='' && $('#node-input-attributeId').val()){
                $('#node-input-name').attr('placeholder',$('#node-input-deviceNodeId').text()+' - '+$('#node-input-capabilityId').val())
            }
        },
        //editor height 변화에 따라 attr-container의 height를 조정한다.
        oneditresize: function (size) {
            var rows;
            var resizeContainer;
            var editorRow;

            if (this.type == ST_COMMAND_DEVICE) {
                rows = $("#dialog-form>div:not('[class$=container-row]')");
                editorRow = $("#dialog-form>div.actuator-container-row");
                resizeContainer = $("#cmd-list-container");
            } else {
                //event, sensor
                rows = $("#dialog-form>div:not('[class$=container-row]')");
                editorRow = $("#dialog-form>div.sensor-container-row");
                resizeContainer = $("#attr-list-container");
            }

            var height = size.height;
            for (var i = 0; i < rows.size(); i++) {
                height -= $(rows[i]).outerHeight(true);
            }

            height -= (parseInt(editorRow.css("marginTop")) + parseInt(editorRow.css("marginBottom")))
            resizeContainer.editableList('height', height - 100)
        }
    });
</script>
